<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--
 // @author CARLOS SANTANDER
-->
<mapper namespace="Presupuesto">
    
    <resultMap id="PresupuestoMap" type="Presupuesto">
        
        <result property="ceco_id" column="ceco_id"/>
        <result property="ceco_codigo" column="ceco_codigo"/>        
        <result property="ceco_nombre" column="ceco_nombre"/>
        <result property="ceco_estado" column="ceco_estado"/>
        <result property="ano_eje" column="ano_eje"/>
        <result property="sec_ejec" column="sec_ejec"/>        
        <result property="ejecutora" column="ejecutora"/>
        <result property="nombre" column="nombre"/>
        <result property="pia" column="pia"/>
        <result property="modificacion" column="modificacion"/>
        <result property="pim" column="pim"/>
        <result property="certificado" column="certificado"/>
        <result property="compromiso_anual" column="compromiso_anual"/>
        <result property="compromiso" column="compromiso"/>
        <result property="ejecucion" column="ejecucion"/>                      
        <result property="devengado" column="devengado"/>
        <result property="girado" column="girado"/>
        <result property="pagado" column="pagado"/>
        <result property="recaudado" column="recaudado"/>
        <result property="mes" column="mes"/>
        <result property="nombre_mes" column="nombre_mes"/>
        <result property="categoria_gasto" column="categoria_gasto"/>  
        <result property="tipo_transaccion" column="tipo_transaccion"/>
        <result property="generica" column="generica"/>
        <result property="clasificador" column="clasificador"/>
        <result property="descripcion" column="descripcion"/>
        <result property="tipo_act_proy" column="tipo_act_proy"/>
        <result property="codigo" column="codigo"/>        
        <result property="programa_ppto" column="programa_ppto"/>
        <result property="nombre_programa_ppto" column="nombre_programa_ppto"/>        
        <result property="act_proy" column="act_proy"/>
        <result property="nombre_act_proy" column="nombre_act_proy"/>
        <result property="componente" column="componente"/>
        <result property="nombre_componente" column="nombre_componente"/>        
        <result property="funcion" column="funcion"/>
        <result property="nombre_funcion" column="nombre_funcion"/>
        <result property="programa" column="programa"/>
        <result property="nombre_programa" column="nombre_programa"/>
        <result property="sub_programa" column="sub_programa"/>
        <result property="nombre_sub_programa" column="nombre_sub_programa"/>
        <result property="sec_func" column="sec_func"/>
        <result property="nombre_sec_func" column="nombre_sec_func"/>        
        <result property="fuente_financ_agregada" column="fuente_financ_agregada"/>
        <result property="nombre_fuente_financ_agregada" column="nombre_fuente_financ_agregada"/>        
        <result property="fuente_financ" column="fuente_financ"/>
        <result property="nombre_fuente_financ" column="nombre_fuente_financ"/>
        <result property="categ_gasto" column="categ_gasto"/>
        <result property="nombre_categ_gasto" column="nombre_categ_gasto"/>                
        <result property="generica_clasif" column="generica_clasif"/>
        <result property="nombre_generica_clasif" column="nombre_generica_clasif"/>        
        <result property="subgenerica_clasif" column="subgenerica_clasif"/>
        <result property="nombre_subgenerica_clasif" column="nombre_subgenerica_clasif"/>        
        <result property="subgenerica_det_clasif" column="subgenerica_det_clasif"/>
        <result property="nombre_subgenerica_det_clasif" column="nombre_subgenerica_det_clasif"/>        
        <result property="especifica_clasif" column="especifica_clasif"/>
        <result property="nombre_especifica_clasif" column="nombre_especifica_clasif"/>        
        <result property="especifica_det_clasif" column="especifica_det_clasif"/>
        <result property="nombre_especifica_det_clasif" column="nombre_especifica_det_clasif"/>                      
        <result property="categoria_ingreso" column="categoria_ingreso"/>
        <result property="nombre_categoria_ingreso" column="nombre_categoria_ingreso"/>     
        <result property="tipo_recurso" column="tipo_recurso"/>
        <result property="nombre_tipo_recurso" column="nombre_tipo_recurso"/> 
        <result property="banco" column="banco"/>
        <result property="nombre_banco" column="nombre_banco"/>
        <result property="cta_cte" column="cta_cte"/>
        <result property="nombre_cta_cte" column="nombre_cta_cte"/>
        <result property="distrito" column="distrito"/>
        <result property="nombre_distrito" column="nombre_distrito"/>        
        <result property="provincia" column="provincia"/>
        <result property="nombre_provincia" column="nombre_provincia"/>        
        <result property="proyecto_snip" column="proyecto_snip"/>
        <result property="nombre_ejecutora" column="nombre_ejecutora"/>
        <result property="glosa" column="glosa"/>
        <result property="certificacion" column="certificacion"/>
        <result property="cod_doc" column="cod_doc"/> 
        <result property="secuencia" column="secuencia"/>
        <result property="correlativo" column="correlativo"/>       
        <result property="fecha_doc" column="fecha_doc"/>
        <result property="sec_nota" column="sec_nota"/>
        <result property="monto" column="monto"/>        
        <result property="monto0" column="monto0"/> 
        <result property="monto1" column="monto1"/> 
        <result property="monto2" column="monto2"/> 
        <result property="monto3" column="monto3"/> 
        <result property="monto4" column="monto4"/> 
        <result property="monto5" column="monto5"/> 
        <result property="monto6" column="monto6"/> 
        <result property="monto7" column="monto7"/> 
        <result property="monto8" column="monto8"/> 
        <result property="monto9" column="monto9"/>         
        <result property="nombre_documento" column="nombre_documento"/>
        <result property="num_doc" column="num_doc"/>        
        <result property="tipo_registro" column="tipo_registro"/>
        <result property="etapa" column="etapa"/> 
        <result property="estado_registro" column="estado_registro"/>
        <result property="estado_envio" column="estado_envio"/>        
        <result property="expediente" column="expediente"/> 
        <result property="ciclo" column="ciclo"/>
        <result property="fase" column="fase"/>
        <result property="ruc" column="ruc"/>
        
    </resultMap>
    
    <select id="getCentroCosto" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT ceco_id, ceco_codigo, ceco_nombre, sec_ejec, ceco_estado
        FROM presupuesto.centro_costo ${c}
    </select>
    
    <insert id="insertCentroCosto" parameterType="Presupuesto" >
        <selectKey keyProperty="ceco_id" resultType="int" order="BEFORE">
            select cast(((case when max(ceco_id) is null then 0 else max(ceco_id) end) +1) as int) from presupuesto.centro_costo
        </selectKey>
        INSERT INTO presupuesto.centro_costo(
        ceco_id, ceco_codigo, ceco_nombre, sec_ejec, ceco_estado)
        VALUES (#{ceco_id}, #{ceco_codigo}, #{ceco_nombre}, #{sec_ejec}, #{ceco_estado});
    </insert>
    
    <select id="getNroRegCeco" parameterType="HashMap" resultType="Integer">
        SELECT count(ceco_id)::integer
        FROM presupuesto.centro_costo ${c}            
    </select>   
              
    <update id="updateCentroCosto" parameterType="Presupuesto"> 
        UPDATE presupuesto.centro_costo
        SET ceco_codigo=#{ceco_codigo}, ceco_nombre=#{ceco_nombre}, sec_ejec=#{sec_ejec}, ceco_estado=#{ceco_estado}
        WHERE ceco_id=#{ceco_id};
    </update>
    
    <delete id="deleteCentroCosto" parameterType="Presupuesto">        
        DELETE FROM presupuesto.centro_costo
        WHERE ceco_id=#{ceco_id};
    </delete>
    
    <select id="getMetaCentroCosto" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT m.ano_eje, m.sec_ejec, ej.ejecutora, trim(ej.nombre) as nombre, m.sec_func, trim(fi.nombre) as descripcion, mc.ceco_id, cc.ceco_codigo, cc.ceco_nombre
        FROM presupuesto.meta as m
        INNER JOIN presupuesto.finalidad as fi ON (m.ano_eje = fi.ano_eje AND m.finalidad = fi.finalidad AND m.estado = fi.estado)
        INNER JOIN presupuesto.ejecutora as ej ON (m.ano_eje = ej.ano_eje AND m.sec_ejec = ej.sec_ejec AND ej.pliego = '459')
        LEFT JOIN presupuesto.meta_centro_costo as mc ON (m.ano_eje = mc.ano_eje AND m.sec_ejec = mc.sec_ejec AND m.sec_func = mc.sec_func)
        LEFT JOIN presupuesto.centro_costo as cc ON (mc.ceco_id = cc.ceco_id) ${c}
    </select>
    
    <select id="getNroRegMetaCeco" parameterType="HashMap" resultType="Integer">
        SELECT count(ceco_id)::integer
        FROM presupuesto.meta_centro_costo ${c}            
    </select> 
    
    <insert id="insertMetaCentroCosto" parameterType="Presupuesto" >   
        INSERT INTO presupuesto.meta_centro_costo(
        ano_eje, sec_ejec, sec_func, ceco_id)
        VALUES (#{ano_eje}, #{sec_ejec}, #{sec_func}, #{ceco_id});
    </insert>   
              
    <update id="updateMetaCentroCosto" parameterType="Presupuesto"> 
        UPDATE presupuesto.meta_centro_costo
        SET ceco_id=#{ceco_id}
        WHERE ano_eje=#{ano_eje} AND sec_ejec=#{sec_ejec} AND sec_func=#{sec_func};
    </update>
    
    <delete id="deleteMetaCentroCosto" parameterType="Presupuesto">        
        DELETE FROM presupuesto.meta_centro_costo
        WHERE ceco_id=#{ceco_id};
    </delete>
    
    <select id="getListEjecutoras" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT sec_ejec, ejecutora, nombre
        FROM presupuesto.ejecutora ${c}  
    </select>
    
    <select id="getEjecutora" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT sec_ejec, ejecutora, nombre
        FROM presupuesto.ejecutora ${c}  
    </select>
    
    <select id="getListA単os" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT ano_eje
        FROM presupuesto.gasto ${c}  
    </select>
    
    <select id="getListMetaA単os" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT ano_eje
        FROM presupuesto.meta ${c}  
    </select>
    
    <select id="getListNotasA単os" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT ano_eje
        FROM presupuesto.nota_modificatoria_cab ${c}  
    </select>
    
    <select id="getListMeses" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT mes, nombre
        FROM utilitarios.meses ${c}  
    </select>
    
    <select id="getListA単osIngreso" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT ano_eje
        FROM presupuesto.ingreso ${c}  
    </select>
    
    <select id="getHistorico" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT ano_eje, SUM(pia) as pia, SUM(modificacion) as modificacion, SUM(pim) as pim, 
        SUM(certificado) as certificado, SUM(compromiso_anual) as compromiso_anual, 
        SUM(compromiso) as compromiso, SUM(ejecucion) as ejecucion, SUM(devengado) as devengado, 
        SUM(girado) as girado, SUM(pagado) as pagado
        FROM presupuesto.ejecucion_historica ${c}  
    </select>
    
    <select id="getRecaudacionHistorico" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT ano_eje, SUM(pia) as pia, SUM(modificacion) as modificacion, SUM(pim) as pim, SUM(recaudado) as recaudado
        FROM presupuesto.recaudacion_historica ${c}  
    </select>   
    
    <select id="getEjecutoraHistorico" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT a.ano_eje, a.sec_ejec, b.ejecutora, b.nombre, a.pia, a.modificacion, a.pim, a.certificado, 
        a.compromiso_anual, a.compromiso, a.ejecucion, a.devengado, a.girado, a.pagado
        FROM presupuesto.ejecucion_historica as a
        INNER JOIN presupuesto.ejecutora as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec) ${c}  
    </select> 
    
    <select id="getEjecutoraRecaudacionHistorico" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT a.ano_eje, a.sec_ejec, b.ejecutora, b.nombre, a.pia, a.modificacion, a.pim, a.recaudado
        FROM presupuesto.recaudacion_historica as a
        INNER JOIN presupuesto.ejecutora as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec) ${c}  
    </select> 
    
    <select id="getMensualizado" parameterType="HashMap" resultMap="PresupuestoMap"> 
        SELECT a.mes, a.nombre, b.devengado
        FROM utilitarios.meses as a
        LEFT JOIN (SELECT a.ano_eje, date_part('month', b.fecha_doc)::int as mes, SUM(a.monto_nacional) as devengado
        FROM presupuesto.expediente_meta as a
        INNER JOIN presupuesto.expediente_secuencia as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.expediente = b.expediente 
        AND a.ciclo = b.ciclo AND a.fase = b.fase AND a.secuencia = b.secuencia AND a.correlativo = b.correlativo AND a.estado_envio = b.estado_envio)
        INNER JOIN presupuesto.meta as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_func = c.sec_func AND c.estado = 'A') ${c} ) 
        as b ON (a.mes = b.mes) ORDER BY a.mes ASC
    </select>
    
    <select id="getMensualizadoHistorico" parameterType="HashMap" resultMap="PresupuestoMap"> 
        SELECT a.ano_eje, d.pim, SUM(a.monto_nacional) as devengado
        FROM presupuesto.expediente_meta as a
        INNER JOIN presupuesto.expediente_secuencia as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.expediente = b.expediente 
        AND a.ciclo = b.ciclo AND a.fase = b.fase AND a.secuencia = b.secuencia AND a.correlativo = b.correlativo AND a.estado_envio = b.estado_envio)
        INNER JOIN presupuesto.meta as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_func = c.sec_func AND c.estado = 'A')
        INNER JOIN presupuesto.ejecucion_historica as d ON (a.ano_eje = d.ano_eje AND a.sec_ejec = d.sec_ejec) ${c}
    </select> 
    
    <select id="getEjecucionPorCategoria" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT a.ano_eje, c.categoria_gasto, f.nombre, SUM(a.presupuesto) as pia, SUM(a.presupuesto) + SUM(a.modificacion) as pim,
        SUM(d.certificado) as certificado, SUM(d.compromiso_anual) as compromiso_anual, SUM(e.devengado) as devengado
        FROM presupuesto.gasto as a
        LEFT JOIN presupuesto.especifica_det as b ON (a.ano_eje = b.ano_eje AND a.id_clasificador = b.id_clasificador AND b.estado= 'A')
        LEFT JOIN presupuesto.subgenerica_det as c ON (b.ano_eje = c.ano_eje AND b.tipo_transaccion = c.tipo_transaccion AND 
        b.generica = c.generica AND b.subgenerica = c.subgenerica AND b.subgenerica_det = c.subgenerica_det AND b.estado = c.estado)
        LEFT JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, a.fuente_financ, a.certificado, b.total - a.certificado as compromiso_anual
        FROM (SELECT a.ano_eje, a.sec_ejec, b.sec_func, b.id_clasificador, a.fuente_financ, SUM(b.monto) as certificado
        FROM presupuesto.certificado_fase as a INNER JOIN presupuesto.certificado_meta as b 
        ON (a.ano_eje=b.ano_eje AND a.sec_ejec=b.sec_ejec AND a.certificado=b.certificado AND a.secuencia=b.secuencia AND a.estado_registro=b.estado_registro) 
        WHERE a.secuencia_padre = '0000' AND a.estado_registro = 'A'
        GROUP BY a.ano_eje, a.sec_ejec, b.sec_func, b.id_clasificador, a.fuente_financ) as a
        INNER JOIN (SELECT a.ano_eje, a.sec_ejec, b.sec_func, b.id_clasificador, a.fuente_financ, SUM(b.monto) as total
        FROM presupuesto.certificado_fase as a INNER JOIN presupuesto.certificado_meta as b 
        ON (a.ano_eje=b.ano_eje AND a.sec_ejec=b.sec_ejec AND a.certificado=b.certificado AND a.secuencia=b.secuencia AND a.estado_registro=b.estado_registro) 
        WHERE a.estado_registro = 'A' GROUP BY a.ano_eje, a.sec_ejec, b.sec_func, b.id_clasificador, a.fuente_financ) as b 
        ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_func = b.sec_func AND a.id_clasificador = b.id_clasificador AND a.fuente_financ = b.fuente_financ)) as d
        ON (a.ano_eje = d.ano_eje AND a.sec_ejec = d.sec_ejec AND a.sec_func = d.sec_func AND a.id_clasificador = d.id_clasificador AND a.fuente_financ = d.fuente_financ)
        LEFT JOIN ((SELECT a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ, SUM(a.monto_nacional) as devengado
        FROM presupuesto.expediente_meta as a INNER JOIN (SELECT ano_eje, sec_ejec, expediente, fuente_financ FROM presupuesto.expediente_fase
        WHERE ciclo = 'G' AND fase = 'D'  AND estado_envio = 'A' 
        GROUP BY ano_eje, sec_ejec, expediente, fuente_financ) as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.expediente = b.expediente)
        WHERE a.estado_envio = 'A' AND a.ciclo = 'G' AND a.fase = 'D' GROUP BY a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ)) as e
        ON (a.ano_eje = e.ano_eje AND a.sec_ejec = e.sec_ejec AND a.sec_func = e.sec_func AND a.id_clasificador = e.id_clasificador AND a.fuente_financ = e.fuente_financ)
        LEFT JOIN presupuesto.categoria_gasto as f ON (a.ano_eje = f.ano_eje AND c.categoria_gasto = f.categ_gasto) ${c}  
    </select> 
    
    <select id="getEjecucionPorGenerica" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT a.ano_eje, f.clasificador, f.descripcion, SUM(a.presupuesto) as pia, SUM(a.presupuesto) + SUM(a.modificacion) as pim,
        SUM(d.certificado) as certificado, SUM(d.compromiso_anual) as compromiso_anual, SUM(e.devengado) as devengado
        FROM presupuesto.gasto as a
        LEFT JOIN presupuesto.especifica_det as b ON (a.ano_eje = b.ano_eje AND a.id_clasificador = b.id_clasificador AND b.estado= 'A')
        LEFT JOIN presupuesto.subgenerica_det as c ON (b.ano_eje = c.ano_eje AND b.tipo_transaccion = c.tipo_transaccion AND 
        b.generica = c.generica AND b.subgenerica = c.subgenerica AND b.subgenerica_det = c.subgenerica_det AND b.estado = c.estado)
        LEFT JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, a.fuente_financ, a.certificado, b.total - a.certificado as compromiso_anual
        FROM (SELECT a.ano_eje, a.sec_ejec, b.sec_func, b.id_clasificador, a.fuente_financ, SUM(b.monto) as certificado
        FROM presupuesto.certificado_fase as a INNER JOIN presupuesto.certificado_meta as b 
        ON (a.ano_eje=b.ano_eje AND a.sec_ejec=b.sec_ejec AND a.certificado=b.certificado AND a.secuencia=b.secuencia AND a.estado_registro=b.estado_registro) 
        WHERE a.secuencia_padre = '0000' AND a.estado_registro = 'A'
        GROUP BY a.ano_eje, a.sec_ejec, b.sec_func, b.id_clasificador, a.fuente_financ) as a
        INNER JOIN (SELECT a.ano_eje, a.sec_ejec, b.sec_func, b.id_clasificador, a.fuente_financ, SUM(b.monto) as total
        FROM presupuesto.certificado_fase as a INNER JOIN presupuesto.certificado_meta as b 
        ON (a.ano_eje=b.ano_eje AND a.sec_ejec=b.sec_ejec AND a.certificado=b.certificado AND a.secuencia=b.secuencia AND a.estado_registro=b.estado_registro) 
        WHERE a.estado_registro = 'A' GROUP BY a.ano_eje, a.sec_ejec, b.sec_func, b.id_clasificador, a.fuente_financ) as b 
        ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_func = b.sec_func AND a.id_clasificador = b.id_clasificador AND a.fuente_financ = b.fuente_financ)) as d
        ON (a.ano_eje = d.ano_eje AND a.sec_ejec = d.sec_ejec AND a.sec_func = d.sec_func AND a.id_clasificador = d.id_clasificador AND a.fuente_financ = d.fuente_financ)
        LEFT JOIN ((SELECT a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ, SUM(a.monto_nacional) as devengado
        FROM presupuesto.expediente_meta as a INNER JOIN (SELECT ano_eje, sec_ejec, expediente, fuente_financ FROM presupuesto.expediente_fase
        WHERE ciclo = 'G' AND fase = 'D'  AND estado_envio = 'A' 
        GROUP BY ano_eje, sec_ejec, expediente, fuente_financ) as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.expediente = b.expediente)
        WHERE a.estado_envio = 'A' AND a.ciclo = 'G' AND a.fase = 'D' GROUP BY a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ)) as e
        ON (a.ano_eje = e.ano_eje AND a.sec_ejec = e.sec_ejec AND a.sec_func = e.sec_func AND a.id_clasificador = e.id_clasificador AND a.fuente_financ = e.fuente_financ)
        LEFT JOIN presupuesto.generica as f ON (a.ano_eje = f.ano_eje AND c.tipo_transaccion = f.tipo_transaccion AND c.generica = f.generica AND f.estado = 'A') ${c}   
    </select> 
    
    <select id="getEjecucionPorFuente" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT a.ano_eje, f.fuente_financ_agregada, g.nombre, SUM(a.presupuesto) as pia, SUM(a.presupuesto) + SUM(a.modificacion) as pim, 
        SUM(d.certificado) as certificado, SUM(d.compromiso_anual) as compromiso_anual, SUM(e.devengado) as devengado
        FROM presupuesto.gasto as a
        LEFT JOIN presupuesto.especifica_det as b ON (a.ano_eje = b.ano_eje AND a.id_clasificador = b.id_clasificador AND b.estado= 'A')
        LEFT JOIN presupuesto.subgenerica_det as c ON (b.ano_eje = c.ano_eje AND b.tipo_transaccion = c.tipo_transaccion AND 
        b.generica = c.generica AND b.subgenerica = c.subgenerica AND b.subgenerica_det = c.subgenerica_det AND b.estado = c.estado)
        LEFT JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, a.fuente_financ, a.certificado, b.total - a.certificado as compromiso_anual
        FROM (SELECT a.ano_eje, a.sec_ejec, b.sec_func, b.id_clasificador, a.fuente_financ, SUM(b.monto) as certificado
        FROM presupuesto.certificado_fase as a INNER JOIN presupuesto.certificado_meta as b 
        ON (a.ano_eje=b.ano_eje AND a.sec_ejec=b.sec_ejec AND a.certificado=b.certificado AND a.secuencia=b.secuencia AND a.estado_registro=b.estado_registro) 
        WHERE a.secuencia_padre = '0000' AND a.estado_registro = 'A'
        GROUP BY a.ano_eje, a.sec_ejec, b.sec_func, b.id_clasificador, a.fuente_financ) as a
        INNER JOIN (SELECT a.ano_eje, a.sec_ejec, b.sec_func, b.id_clasificador, a.fuente_financ, SUM(b.monto) as total
        FROM presupuesto.certificado_fase as a INNER JOIN presupuesto.certificado_meta as b 
        ON (a.ano_eje=b.ano_eje AND a.sec_ejec=b.sec_ejec AND a.certificado=b.certificado AND a.secuencia=b.secuencia AND a.estado_registro=b.estado_registro) 
        WHERE a.estado_registro = 'A' GROUP BY a.ano_eje, a.sec_ejec, b.sec_func, b.id_clasificador, a.fuente_financ) as b 
        ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_func = b.sec_func AND a.id_clasificador = b.id_clasificador AND a.fuente_financ = b.fuente_financ)) as d
        ON (a.ano_eje = d.ano_eje AND a.sec_ejec = d.sec_ejec AND a.sec_func = d.sec_func AND a.id_clasificador = d.id_clasificador AND a.fuente_financ = d.fuente_financ)
        LEFT JOIN ((SELECT a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ, SUM(a.monto_nacional) as devengado
        FROM presupuesto.expediente_meta as a INNER JOIN (SELECT ano_eje, sec_ejec, expediente, fuente_financ FROM presupuesto.expediente_fase
        WHERE ciclo = 'G' AND fase = 'D'  AND estado_envio = 'A' 
        GROUP BY ano_eje, sec_ejec, expediente, fuente_financ) as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.expediente = b.expediente)
        WHERE a.estado_envio = 'A' AND a.ciclo = 'G' AND a.fase = 'D' GROUP BY a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ)) as e
        ON (a.ano_eje = e.ano_eje AND a.sec_ejec = e.sec_ejec AND a.sec_func = e.sec_func AND a.id_clasificador = e.id_clasificador AND a.fuente_financ = e.fuente_financ)
        LEFT JOIN presupuesto.fuente_financ as f ON (a.ano_eje = f.ano_eje AND a.fuente_financ = f.fuente_financ)
        LEFT JOIN presupuesto.fuente_financ_agregada as g ON (f.ano_eje = g.ano_eje AND f.fuente_financ_agregada = g.fuente_financ_agregada) ${c}  
    </select> 
    
    <select id="getEjecucionPorActProy" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT a.ano_eje, f.act_proy, g.nombre, substring(f.act_proy from 1 for 1) as tipo_act_proy, SUM(a.presupuesto) as pia, SUM(a.presupuesto) + SUM(a.modificacion) as pim,
        SUM(d.certificado) as certificado, SUM(d.compromiso_anual) as compromiso_anual, SUM(e.devengado) as devengado
        FROM presupuesto.gasto as a
        LEFT JOIN presupuesto.especifica_det as b ON (a.ano_eje = b.ano_eje AND a.id_clasificador = b.id_clasificador AND b.estado= 'A')
        LEFT JOIN presupuesto.subgenerica_det as c ON (b.ano_eje = c.ano_eje AND b.tipo_transaccion = c.tipo_transaccion AND 
        b.generica = c.generica AND b.subgenerica = c.subgenerica AND b.subgenerica_det = c.subgenerica_det AND b.estado = c.estado)
        LEFT JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, a.fuente_financ, a.certificado, b.total - a.certificado as compromiso_anual
        FROM (SELECT a.ano_eje, a.sec_ejec, b.sec_func, b.id_clasificador, a.fuente_financ, SUM(b.monto) as certificado
        FROM presupuesto.certificado_fase as a INNER JOIN presupuesto.certificado_meta as b 
        ON (a.ano_eje=b.ano_eje AND a.sec_ejec=b.sec_ejec AND a.certificado=b.certificado AND a.secuencia=b.secuencia AND a.estado_registro=b.estado_registro) 
        WHERE a.secuencia_padre = '0000' AND a.estado_registro = 'A'
        GROUP BY a.ano_eje, a.sec_ejec, b.sec_func, b.id_clasificador, a.fuente_financ) as a
        INNER JOIN (SELECT a.ano_eje, a.sec_ejec, b.sec_func, b.id_clasificador, a.fuente_financ, SUM(b.monto) as total
        FROM presupuesto.certificado_fase as a INNER JOIN presupuesto.certificado_meta as b 
        ON (a.ano_eje=b.ano_eje AND a.sec_ejec=b.sec_ejec AND a.certificado=b.certificado AND a.secuencia=b.secuencia AND a.estado_registro=b.estado_registro) 
        WHERE a.estado_registro = 'A' GROUP BY a.ano_eje, a.sec_ejec, b.sec_func, b.id_clasificador, a.fuente_financ) as b 
        ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_func = b.sec_func AND a.id_clasificador = b.id_clasificador AND a.fuente_financ = b.fuente_financ)) as d
        ON (a.ano_eje = d.ano_eje AND a.sec_ejec = d.sec_ejec AND a.sec_func = d.sec_func AND a.id_clasificador = d.id_clasificador AND a.fuente_financ = d.fuente_financ)
        LEFT JOIN ((SELECT a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ, SUM(a.monto_nacional) as devengado
        FROM presupuesto.expediente_meta as a INNER JOIN (SELECT ano_eje, sec_ejec, expediente, fuente_financ FROM presupuesto.expediente_fase
        WHERE ciclo = 'G' AND fase = 'D'  AND estado_envio = 'A' 
        GROUP BY ano_eje, sec_ejec, expediente, fuente_financ) as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.expediente = b.expediente)
        WHERE a.estado_envio = 'A' AND a.ciclo = 'G' AND a.fase = 'D' GROUP BY a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ)) as e
        ON (a.ano_eje = e.ano_eje AND a.sec_ejec = e.sec_ejec AND a.sec_func = e.sec_func AND a.id_clasificador = e.id_clasificador AND a.fuente_financ = e.fuente_financ)
        LEFT JOIN presupuesto.meta as f ON (a.ano_eje = f.ano_eje AND a.sec_ejec = f.sec_ejec AND a.sec_func = f.sec_func AND f.estado = 'A')
        LEFT JOIN presupuesto.act_proy_nombre as g ON (a.ano_eje = g.ano_eje AND f.act_proy = g.act_proy AND f.estado = g.estado) ${c}  
    </select> 
    
    <select id="getEjecucionPorActProyTotal" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT a.ano_eje, substring(f.act_proy from 1 for 1) as tipo_act_proy, SUM(a.presupuesto) as pia, SUM(a.presupuesto) + SUM(a.modificacion) as pim,
        SUM(d.certificado) as certificado, SUM(d.compromiso_anual) as compromiso_anual, SUM(e.devengado) as devengado
        FROM presupuesto.gasto as a
        LEFT JOIN presupuesto.especifica_det as b ON (a.ano_eje = b.ano_eje AND a.id_clasificador = b.id_clasificador AND b.estado= 'A')
        LEFT JOIN presupuesto.subgenerica_det as c ON (b.ano_eje = c.ano_eje AND b.tipo_transaccion = c.tipo_transaccion AND 
        b.generica = c.generica AND b.subgenerica = c.subgenerica AND b.subgenerica_det = c.subgenerica_det AND b.estado = c.estado)
        LEFT JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, a.fuente_financ, a.certificado, b.total - a.certificado as compromiso_anual
        FROM (SELECT a.ano_eje, a.sec_ejec, b.sec_func, b.id_clasificador, a.fuente_financ, SUM(b.monto) as certificado
        FROM presupuesto.certificado_fase as a INNER JOIN presupuesto.certificado_meta as b 
        ON (a.ano_eje=b.ano_eje AND a.sec_ejec=b.sec_ejec AND a.certificado=b.certificado AND a.secuencia=b.secuencia AND a.estado_registro=b.estado_registro) 
        WHERE a.secuencia_padre = '0000' AND a.estado_registro = 'A'
        GROUP BY a.ano_eje, a.sec_ejec, b.sec_func, b.id_clasificador, a.fuente_financ) as a
        INNER JOIN (SELECT a.ano_eje, a.sec_ejec, b.sec_func, b.id_clasificador, a.fuente_financ, SUM(b.monto) as total
        FROM presupuesto.certificado_fase as a INNER JOIN presupuesto.certificado_meta as b 
        ON (a.ano_eje=b.ano_eje AND a.sec_ejec=b.sec_ejec AND a.certificado=b.certificado AND a.secuencia=b.secuencia AND a.estado_registro=b.estado_registro) 
        WHERE a.estado_registro = 'A' GROUP BY a.ano_eje, a.sec_ejec, b.sec_func, b.id_clasificador, a.fuente_financ) as b 
        ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_func = b.sec_func AND a.id_clasificador = b.id_clasificador AND a.fuente_financ = b.fuente_financ)) as d
        ON (a.ano_eje = d.ano_eje AND a.sec_ejec = d.sec_ejec AND a.sec_func = d.sec_func AND a.id_clasificador = d.id_clasificador AND a.fuente_financ = d.fuente_financ)
        LEFT JOIN ((SELECT a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ, SUM(a.monto_nacional) as devengado
        FROM presupuesto.expediente_meta as a INNER JOIN (SELECT ano_eje, sec_ejec, expediente, fuente_financ FROM presupuesto.expediente_fase
        WHERE ciclo = 'G' AND fase = 'D'  AND estado_envio = 'A' 
        GROUP BY ano_eje, sec_ejec, expediente, fuente_financ) as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.expediente = b.expediente)
        WHERE a.estado_envio = 'A' AND a.ciclo = 'G' AND a.fase = 'D' GROUP BY a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ)) as e
        ON (a.ano_eje = e.ano_eje AND a.sec_ejec = e.sec_ejec AND a.sec_func = e.sec_func AND a.id_clasificador = e.id_clasificador AND a.fuente_financ = e.fuente_financ)
        LEFT JOIN presupuesto.meta as f ON (a.ano_eje = f.ano_eje AND a.sec_ejec = f.sec_ejec AND a.sec_func = f.sec_func AND f.estado = 'A')
        LEFT JOIN presupuesto.act_proy_nombre as g ON (a.ano_eje = g.ano_eje AND f.act_proy = g.act_proy AND f.estado = g.estado) ${c}  
    </select> 
    
    <select id="getListCategoriaPresupuestal" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT b.programa_ppto as codigo, trim(b.nombre) as nombre FROM presupuesto.meta as a 
        INNER JOIN presupuesto.programa_ppto_nombre as b ON (a.programa_ppto=b.programa_ppto AND a.ano_eje=b.ano_eje AND a.estado=b.estado) ${c}  
    </select>
    
    <select id="getListProductoProyecto" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT b.act_proy as codigo, trim(b.nombre) as nombre FROM presupuesto.meta as a 
        INNER JOIN presupuesto.act_proy_nombre as b ON (a.act_proy=b.act_proy AND a.ano_eje=b.ano_eje AND a.estado=b.estado) ${c}  
    </select>
    
    <select id="getListActividadAccionInvObra" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT b.componente as codigo, trim(b.nombre) as nombre FROM presupuesto.meta as a 
        INNER JOIN presupuesto.componente_nombre as b ON (a.componente=b.componente AND a.ano_eje=b.ano_eje AND a.estado=b.estado) ${c}  
    </select>
    
    <select id="getListFuncion" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT b.funcion as codigo, trim(b.nombre) as nombre FROM presupuesto.meta as a 
        INNER JOIN presupuesto.funcion as b ON (a.funcion=b.funcion AND a.ano_eje=b.ano_eje AND a.estado=b.estado) ${c}  
    </select>
    
    <select id="getListDivFuncion" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT b.programa as codigo, trim(b.nombre) as nombre FROM presupuesto.meta as a 
        INNER JOIN presupuesto.programa_nombre as b ON (a.programa=b.programa AND a.ano_eje=b.ano_eje AND a.estado=b.estado) ${c}  
    </select>
    
    <select id="getListGrupFuncion" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT b.sub_programa as codigo, trim(b.nombre) as nombre FROM presupuesto.meta as a 
        INNER JOIN presupuesto.sub_programa_nombre as b ON (a.sub_programa=b.sub_programa AND a.ano_eje=b.ano_eje AND a.estado=b.estado) ${c}  
    </select>
    
    <select id="getListMeta" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT a.sec_func as codigo, trim(b.nombre) as nombre FROM presupuesto.meta as a
        INNER JOIN presupuesto.finalidad as b ON (a.finalidad=b.finalidad AND a.ano_eje=b.ano_eje AND a.estado=b.estado) ${c}  
    </select>
    
    <select id="getListFuente" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT c.fuente_financ_agregada as codigo, trim(c.nombre) as nombre FROM presupuesto.gasto as a 
        INNER JOIN presupuesto.fuente_financ as b ON (a.fuente_financ=b.fuente_financ AND a.ano_eje=b.ano_eje)
        INNER JOIN presupuesto.fuente_financ_agregada as c ON (b.fuente_financ_agregada=c.fuente_financ_agregada 
        AND b.ano_eje=c.ano_eje AND b.estado=c.estado) ${c}  
    </select>
    
    <select id="getListFuenteIngreso" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT c.fuente_financ_agregada as codigo, trim(c.nombre) as nombre FROM presupuesto.ingreso as a 
        INNER JOIN presupuesto.fuente_financ as b ON (a.fuente_financ=b.fuente_financ AND a.ano_eje=b.ano_eje)
        INNER JOIN presupuesto.fuente_financ_agregada as c ON (b.fuente_financ_agregada=c.fuente_financ_agregada 
        AND b.ano_eje=c.ano_eje AND b.estado=c.estado) ${c}  
    </select>
    
    <select id="getListRubro" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT b.fuente_financ as codigo, trim(b.nombre) as nombre FROM presupuesto.gasto as a 
        INNER JOIN presupuesto.fuente_financ as b ON (a.fuente_financ=b.fuente_financ AND a.ano_eje=b.ano_eje) ${c}  
    </select>
    
    <select id="getListRubroIngreso" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT b.fuente_financ as codigo, trim(b.nombre) as nombre FROM presupuesto.ingreso as a 
        INNER JOIN presupuesto.fuente_financ as b ON (a.fuente_financ=b.fuente_financ AND a.ano_eje=b.ano_eje) ${c}  
    </select>
    
    <select id="getListCategoriaGasto" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT d.categ_gasto as codigo, trim(d.nombre) as nombre FROM presupuesto.gasto as a 
        INNER JOIN presupuesto.especifica_det as b ON (a.id_clasificador=b.id_clasificador AND a.ano_eje=b.ano_eje) 
        INNER JOIN presupuesto.subgenerica_det as c ON (b.tipo_transaccion=c.tipo_transaccion AND b.generica=c.generica AND 
        b.subgenerica=c.subgenerica AND b.subgenerica_det=c.subgenerica_det AND b.ano_eje=c.ano_eje AND b.estado=c.estado)
        INNER JOIN presupuesto.categoria_gasto as d ON (c.categoria_gasto=d.categ_gasto AND c.ano_eje=d.ano_eje AND c.estado=d.estado) ${c}  
    </select>
    
    <select id="getListCategoriaIngreso" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT d.categoria_ingreso as codigo, trim(d.descripcion) as nombre FROM presupuesto.ingreso as a 
        INNER JOIN presupuesto.especifica_det as b ON (a.id_clasificador=b.id_clasificador AND a.ano_eje=b.ano_eje) 
        INNER JOIN presupuesto.subgenerica_det as c ON (b.tipo_transaccion=c.tipo_transaccion AND b.generica=c.generica AND 
        b.subgenerica=c.subgenerica AND b.subgenerica_det=c.subgenerica_det AND b.ano_eje=c.ano_eje AND b.estado=c.estado)
        INNER JOIN presupuesto.categoria_ingreso as d ON (c.categoria_ingreso=d.categoria_ingreso AND c.ano_eje=d.ano_eje AND c.estado=d.estado) ${c}  
    </select>
    
    <select id="getListGenerica" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT c.tipo_transaccion, c.generica, c.clasificador as codigo, trim(c.descripcion) as nombre FROM presupuesto.gasto as a 
        INNER JOIN presupuesto.especifica_det as b ON (a.id_clasificador=b.id_clasificador AND a.ano_eje=b.ano_eje) 
        INNER JOIN presupuesto.generica as c ON (b.tipo_transaccion=c.tipo_transaccion AND b.generica=c.generica 
        AND b.ano_eje=c.ano_eje AND b.estado=c.estado) ${c}  
    </select>
    
    <select id="getListGenericaIngreso" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT c.tipo_transaccion, c.generica, c.clasificador as codigo, trim(c.descripcion) as nombre FROM presupuesto.ingreso as a 
        INNER JOIN presupuesto.especifica_det as b ON (a.id_clasificador=b.id_clasificador AND a.ano_eje=b.ano_eje) 
        INNER JOIN presupuesto.generica as c ON (b.tipo_transaccion=c.tipo_transaccion AND b.generica=c.generica 
        AND b.ano_eje=c.ano_eje AND b.estado=c.estado) ${c}  
    </select>
    
    <select id="getListSubGenerica" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT c.tipo_transaccion, c.generica, c.subgenerica, c.clasificador as codigo, trim(c.descripcion) as nombre FROM presupuesto.gasto as a 
        INNER JOIN presupuesto.especifica_det as b ON (a.id_clasificador=b.id_clasificador AND a.ano_eje=b.ano_eje) 
        INNER JOIN presupuesto.subgenerica as c ON (b.tipo_transaccion=c.tipo_transaccion AND b.generica=c.generica 
        AND b.subgenerica=c.subgenerica AND b.ano_eje=c.ano_eje AND b.estado=c.estado) ${c}  
    </select>
    
    <select id="getListSubGenericaIngreso" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT c.tipo_transaccion, c.generica, c.subgenerica, c.clasificador as codigo, trim(c.descripcion) as nombre FROM presupuesto.ingreso as a 
        INNER JOIN presupuesto.especifica_det as b ON (a.id_clasificador=b.id_clasificador AND a.ano_eje=b.ano_eje) 
        INNER JOIN presupuesto.subgenerica as c ON (b.tipo_transaccion=c.tipo_transaccion AND b.generica=c.generica 
        AND b.subgenerica=c.subgenerica AND b.ano_eje=c.ano_eje AND b.estado=c.estado) ${c}  
    </select>
    
    <select id="getListSubGenericaDet" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT c.tipo_transaccion, c.generica, c.subgenerica, c.subgenerica_det, c.clasificador as codigo, trim(c.descripcion) as nombre 
        FROM presupuesto.gasto as a 
        INNER JOIN presupuesto.especifica_det as b ON (a.id_clasificador=b.id_clasificador AND a.ano_eje=b.ano_eje) 
        INNER JOIN presupuesto.subgenerica_det as c ON (b.tipo_transaccion=c.tipo_transaccion AND b.generica=c.generica 
        AND b.subgenerica=c.subgenerica AND b.subgenerica_det=c.subgenerica_det AND b.ano_eje=c.ano_eje AND b.estado=c.estado) ${c}  
    </select>
    
    <select id="getListSubGenericaDetIngreso" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT c.tipo_transaccion, c.generica, c.subgenerica, c.subgenerica_det, c.clasificador as codigo, trim(c.descripcion) as nombre 
        FROM presupuesto.ingreso as a 
        INNER JOIN presupuesto.especifica_det as b ON (a.id_clasificador=b.id_clasificador AND a.ano_eje=b.ano_eje) 
        INNER JOIN presupuesto.subgenerica_det as c ON (b.tipo_transaccion=c.tipo_transaccion AND b.generica=c.generica 
        AND b.subgenerica=c.subgenerica AND b.subgenerica_det=c.subgenerica_det AND b.ano_eje=c.ano_eje AND b.estado=c.estado) ${c}  
    </select>
    
    <select id="getListEspecifica" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT c.tipo_transaccion, c.generica, c.subgenerica, c.subgenerica_det, c.especifica, c.clasificador as codigo, 
        trim(c.descripcion) as nombre FROM presupuesto.gasto as a 
        INNER JOIN presupuesto.especifica_det as b ON (a.id_clasificador=b.id_clasificador AND a.ano_eje=b.ano_eje) 
        INNER JOIN presupuesto.especifica as c ON (b.tipo_transaccion=c.tipo_transaccion AND b.generica=c.generica 
        AND b.subgenerica=c.subgenerica AND b.subgenerica_det=c.subgenerica_det AND b.especifica=c.especifica AND 
        b.ano_eje=c.ano_eje AND b.estado=c.estado) ${c}  
    </select>
    
    <select id="getListEspecificaIngreso" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT c.tipo_transaccion, c.generica, c.subgenerica, c.subgenerica_det, c.especifica, c.clasificador as codigo, 
        trim(c.descripcion) as nombre FROM presupuesto.ingreso as a 
        INNER JOIN presupuesto.especifica_det as b ON (a.id_clasificador=b.id_clasificador AND a.ano_eje=b.ano_eje) 
        INNER JOIN presupuesto.especifica as c ON (b.tipo_transaccion=c.tipo_transaccion AND b.generica=c.generica 
        AND b.subgenerica=c.subgenerica AND b.subgenerica_det=c.subgenerica_det AND b.especifica=c.especifica AND 
        b.ano_eje=c.ano_eje AND b.estado=c.estado) ${c}  
    </select>
    
    <select id="getListEspecificaDet" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT b.tipo_transaccion, b.generica, b.subgenerica, b.subgenerica_det, b.especifica, b.especifica_det, b.clasificador as codigo, 
        trim(b.descripcion) as nombre FROM presupuesto.gasto as a 
        INNER JOIN presupuesto.especifica_det as b ON (a.id_clasificador=b.id_clasificador AND a.ano_eje=b.ano_eje) ${c}  
    </select>
    
    <select id="getListEspecificaDetIngreso" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT b.tipo_transaccion, b.generica, b.subgenerica, b.subgenerica_det, b.especifica, b.especifica_det, b.clasificador as codigo, 
        trim(b.descripcion) as nombre FROM presupuesto.ingreso as a 
        INNER JOIN presupuesto.especifica_det as b ON (a.id_clasificador=b.id_clasificador AND a.ano_eje=b.ano_eje) ${c}  
    </select>
    
    <select id="getListTipoRecurso" parameterType="HashMap" resultMap="PresupuestoMap">     
        SELECT b.tipo_recurso as codigo, trim(b.nombre) as nombre, fu.fuente_financ_agregada, trim(fu.nombre) as nombre_fuente_financ_agregada
        FROM presupuesto.expediente_fase as a 
        INNER JOIN presupuesto.tipo_recurso as b ON (a.ano_eje=b.ano_eje AND a.fuente_financ=b.fuente_financ AND 
        a.tipo_recurso=b.tipo_recurso AND a.estado_envio=b.estado)    
        INNER JOIN presupuesto.fuente_financ as ru ON (a.ano_eje = ru.ano_eje AND a.fuente_financ = ru.fuente_financ AND a.estado_envio = ru.estado)
        INNER JOIN presupuesto.fuente_financ_agregada as fu ON (ru.ano_eje = fu.ano_eje AND ru.fuente_financ_agregada = fu.fuente_financ_agregada AND ru.estado = fu.estado) ${c}  
    </select>
    
    <select id="getListDistrito" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT b.distrito as codigo, trim(b.nombre) as nombre FROM presupuesto.meta as a 
        INNER JOIN presupuesto.distrito as b ON (a.departamento=b.departamento AND a.provincia=b.provincia 
        AND a.distrito=b.distrito AND a.estado=b.estado) ${c}  
    </select>
    
    <select id="getListProvincia" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT b.provincia as codigo, trim(b.nombre) as nombre FROM presupuesto.meta as a 
        INNER JOIN presupuesto.provincia as b ON (a.departamento=b.departamento AND 
        a.provincia=b.provincia AND a.estado=b.estado) ${c}  
    </select>
    
    <select id="getListCentroCosto" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT cc.ceco_id, cc.ceco_codigo as codigo, trim(cc.ceco_nombre) as nombre FROM presupuesto.meta as a
        INNER JOIN presupuesto.meta_centro_costo as mcc ON (a.ano_eje = mcc.ano_eje AND a.sec_ejec = mcc.sec_ejec AND a.sec_func = mcc.sec_func)
        INNER JOIN presupuesto.centro_costo as cc ON (mcc.ceco_id = cc.ceco_id) ${c}  
    </select>
    
    <select id="getListBanco" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT b.banco as codigo, trim(b.nombre) as nombre 
        FROM presupuesto.expediente_secuencia as a 
        INNER JOIN presupuesto.banco as b ON (a.banco=b.banco AND a.estado_envio=b.estado) ${c}  
    </select>
    
    <select id="getListCuentaCorriente" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT b.cta_cte as codigo, trim(b.nombre) as nombre, c.banco, trim(c.nombre) as nombre_banco, a.ano_cta_cte as ano_eje
        FROM presupuesto.expediente_secuencia as a 
        INNER JOIN presupuesto.cta_cte as b ON (a.sec_ejec=b.sec_ejec AND a.ano_cta_cte=b.ano_eje AND a.banco=b.banco AND a.cta_cte=b.cta_cte AND a.estado_envio=b.estado)
        INNER JOIN presupuesto.banco as c ON (b.banco=c.banco AND b.estado=c.estado) ${c}  
    </select>
            
    <select id="getEjecucionAnual" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT ${b} SUM(g.presupuesto) as pia, SUM(g.modificacion) as modificacion, SUM(g.presupuesto) + SUM(g.modificacion) as pim, 
        SUM(f1.certificado) as certificado, SUM(f1.compromiso_anual) as compromiso_anual, SUM(f2.compromiso) as compromiso, 
        SUM(f3.devengado) as devengado, SUM(f4.girado) as girado, SUM(f5.pagado) as pagado FROM presupuesto.gasto as g         
        LEFT JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, a.fuente_financ, a.certificado, b.total - a.certificado as compromiso_anual
        FROM (SELECT a.ano_eje, a.sec_ejec, b.sec_func, b.id_clasificador, a.fuente_financ, SUM(b.monto_nacional) as certificado
        FROM presupuesto.certificado_fase as a INNER JOIN presupuesto.certificado_meta as b 
        ON (a.ano_eje=b.ano_eje AND a.sec_ejec=b.sec_ejec AND a.certificado=b.certificado AND a.secuencia=b.secuencia AND a.estado_registro=b.estado_registro) 
        WHERE a.secuencia_padre = '0000' AND a.estado_registro = 'A'
        GROUP BY a.ano_eje, a.sec_ejec, b.sec_func, b.id_clasificador, a.fuente_financ) as a
        INNER JOIN (SELECT a.ano_eje, a.sec_ejec, b.sec_func, b.id_clasificador, a.fuente_financ, SUM(b.monto_nacional) as total
        FROM presupuesto.certificado_fase as a INNER JOIN presupuesto.certificado_meta as b 
        ON (a.ano_eje=b.ano_eje AND a.sec_ejec=b.sec_ejec AND a.certificado=b.certificado AND a.secuencia=b.secuencia AND a.estado_registro=b.estado_registro) 
        WHERE a.estado_registro = 'A' GROUP BY a.ano_eje, a.sec_ejec, b.sec_func, b.id_clasificador, a.fuente_financ) as b 
        ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_func = b.sec_func AND a.id_clasificador = b.id_clasificador AND a.fuente_financ = b.fuente_financ)) as f1
        ON (g.ano_eje = f1.ano_eje AND g.sec_ejec = f1.sec_ejec AND g.sec_func = f1.sec_func AND g.id_clasificador = f1.id_clasificador AND g.fuente_financ = f1.fuente_financ)		
        LEFT JOIN ((SELECT a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ, SUM(a.monto_nacional) as compromiso
        FROM presupuesto.expediente_meta as a INNER JOIN (SELECT ano_eje, sec_ejec, expediente, ciclo, fase, secuencia, estado_envio, fuente_financ
        FROM presupuesto.expediente_fase GROUP BY ano_eje, sec_ejec, expediente, ciclo, fase, secuencia, estado_envio, fuente_financ) as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.expediente = b.expediente AND a.ciclo = b.ciclo AND a.fase = b.fase AND a.secuencia = b.secuencia AND a.estado_envio = b.estado_envio)  
        WHERE a.estado_envio = 'A' AND a.ciclo = 'G' AND a.fase = 'C' AND a.sec_func != '0000' GROUP BY a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ)) as f2
        ON (g.ano_eje = f2.ano_eje AND g.sec_ejec = f2.sec_ejec AND g.sec_func = f2.sec_func AND g.id_clasificador = f2.id_clasificador AND g.fuente_financ = f2.fuente_financ)							
        LEFT JOIN ((SELECT a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ, SUM(a.monto_nacional) as devengado
        FROM presupuesto.expediente_meta as a INNER JOIN (SELECT ano_eje, sec_ejec, expediente, ciclo, fase, secuencia, estado_envio, fuente_financ
        FROM presupuesto.expediente_fase GROUP BY ano_eje, sec_ejec, expediente, ciclo, fase, secuencia, estado_envio, fuente_financ) as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.expediente = b.expediente AND a.ciclo = b.ciclo AND a.fase = b.fase AND a.secuencia = b.secuencia AND a.estado_envio = b.estado_envio)  
        WHERE a.estado_envio = 'A' AND a.ciclo = 'G' AND a.fase = 'D' AND a.sec_func != '0000' GROUP BY a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ)) as f3
        ON (g.ano_eje = f3.ano_eje AND g.sec_ejec = f3.sec_ejec AND g.sec_func = f3.sec_func AND g.id_clasificador = f3.id_clasificador AND g.fuente_financ = f3.fuente_financ)	
        LEFT JOIN ((SELECT a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ, SUM(a.monto_nacional) as girado
        FROM presupuesto.expediente_meta as a INNER JOIN (SELECT ano_eje, sec_ejec, expediente, ciclo, fase, secuencia, estado_envio, fuente_financ
        FROM presupuesto.expediente_fase GROUP BY ano_eje, sec_ejec, expediente, ciclo, fase, secuencia, estado_envio, fuente_financ) as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.expediente = b.expediente AND a.ciclo = b.ciclo AND a.fase = b.fase AND a.secuencia = b.secuencia AND a.estado_envio = b.estado_envio)  
        WHERE a.estado_envio = 'A' AND a.ciclo = 'G' AND a.fase = 'G' AND a.sec_func != '0000' GROUP BY a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ)) as f4
        ON (g.ano_eje = f4.ano_eje AND g.sec_ejec = f4.sec_ejec AND g.sec_func = f4.sec_func AND g.id_clasificador = f4.id_clasificador AND g.fuente_financ = f4.fuente_financ)													
        LEFT JOIN ((SELECT a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ, SUM(a.monto_nacional) as pagado
        FROM presupuesto.expediente_meta as a INNER JOIN (SELECT ano_eje, sec_ejec, expediente, ciclo, fase, secuencia, estado_envio, fuente_financ
        FROM presupuesto.expediente_fase GROUP BY ano_eje, sec_ejec, expediente, ciclo, fase, secuencia, estado_envio, fuente_financ) as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.expediente = b.expediente AND a.ciclo = b.ciclo AND a.fase = b.fase AND a.secuencia = b.secuencia AND a.estado_envio = b.estado_envio)  
        WHERE a.estado_envio = 'A' AND a.ciclo = 'G' AND a.fase = 'P' AND a.sec_func != '0000' GROUP BY a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ)) as f5
        ON (g.ano_eje = f5.ano_eje AND g.sec_ejec = f5.sec_ejec AND g.sec_func = f5.sec_func AND g.id_clasificador = f5.id_clasificador AND g.fuente_financ = f5.fuente_financ)					
        INNER JOIN presupuesto.fuente_financ as ru ON (g.ano_eje = ru.ano_eje AND g.fuente_financ = ru.fuente_financ AND ru.estado = 'A')
        INNER JOIN presupuesto.fuente_financ_agregada as fu ON (ru.ano_eje = fu.ano_eje AND ru.fuente_financ_agregada = fu.fuente_financ_agregada AND ru.estado = fu.estado)
        INNER JOIN presupuesto.especifica_det as ed ON (g.ano_eje = ed.ano_eje AND g.id_clasificador = ed.id_clasificador AND ed.estado= 'A')        
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_gasto as cg ON (sgd.ano_eje = cg.ano_eje AND sgd.categoria_gasto = cg.categ_gasto AND sgd.estado = cg.estado)        
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)
        INNER JOIN presupuesto.meta as m ON (g.ano_eje = m.ano_eje AND g.sec_ejec = m.sec_ejec AND g.sec_func = m.sec_func AND m.estado = 'A')        
        ${d} JOIN presupuesto.meta_centro_costo as mcc ON (m.ano_eje = mcc.ano_eje AND m.sec_ejec = mcc.sec_ejec AND m.sec_func = mcc.sec_func)
        ${d} JOIN presupuesto.centro_costo as cc ON (mcc.ceco_id = cc.ceco_id)
        INNER JOIN presupuesto.finalidad as fi ON (m.ano_eje = fi.ano_eje AND m.finalidad = fi.finalidad AND m.estado = fi.estado)
        INNER JOIN presupuesto.programa_ppto_nombre as cp ON (m.ano_eje = cp.ano_eje AND m.programa_ppto = cp.programa_ppto AND m.estado = cp.estado)
        INNER JOIN presupuesto.act_proy_nombre as ap ON (m.ano_eje = ap.ano_eje AND m.act_proy = ap.act_proy AND m.estado = ap.estado)
        INNER JOIN presupuesto.componente_nombre as co ON (m.ano_eje = co.ano_eje AND m.componente = co.componente AND m.estado = co.estado)
        INNER JOIN presupuesto.funcion as fn ON (m.ano_eje = fn.ano_eje AND m.funcion = fn.funcion AND m.estado = fn.estado)        
        INNER JOIN presupuesto.programa_nombre as pn ON (m.ano_eje = pn.ano_eje AND m.programa = pn.programa AND m.estado = pn.estado)
        INNER JOIN presupuesto.sub_programa_nombre as spn ON (m.ano_eje = spn.ano_eje AND m.sub_programa = spn.sub_programa AND m.estado = spn.estado)        
        INNER JOIN presupuesto.provincia as pr ON (m.departamento = pr.departamento AND m.provincia = pr.provincia AND m.estado = pr.estado)
        INNER JOIN presupuesto.distrito as di ON (m.departamento = di.departamento AND m.provincia = di.provincia AND m.distrito = di.distrito AND m.estado = di.estado) 
        INNER JOIN presupuesto.ejecutora as ej ON (g.ano_eje = ej.ano_eje AND g.sec_ejec = ej.sec_ejec AND ej.pliego = '459') ${c}  
    </select>
    
    <select id="getEjecucionAnualTipoRec" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT ${b} SUM(f2.compromiso) as compromiso, SUM(f3.devengado) as devengado, SUM(f4.girado) as girado, SUM(f5.pagado) as pagado 
        FROM presupuesto.gasto as g                         	
        LEFT JOIN ((SELECT a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ, b.tipo_recurso, SUM(a.monto_nacional) as compromiso
        FROM presupuesto.expediente_meta as a 
        INNER JOIN (SELECT ano_eje, sec_ejec, expediente, ciclo, fase, secuencia, estado_envio, fuente_financ, tipo_recurso FROM presupuesto.expediente_fase        
        GROUP BY ano_eje, sec_ejec, expediente, ciclo, fase, secuencia, estado_envio, fuente_financ, tipo_recurso) as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.expediente = b.expediente AND a.ciclo = b.ciclo AND a.fase = b.fase AND a.secuencia = b.secuencia AND a.estado_envio = b.estado_envio)  
        WHERE a.estado_envio = 'A' AND a.ciclo = 'G' AND a.fase = 'C' AND a.sec_func != '0000' GROUP BY a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ, b.tipo_recurso)) as f2
        ON (g.ano_eje = f2.ano_eje AND g.sec_ejec = f2.sec_ejec AND g.sec_func = f2.sec_func AND g.id_clasificador = f2.id_clasificador AND g.fuente_financ = f2.fuente_financ)  
        LEFT JOIN ((SELECT a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ, b.tipo_recurso, SUM(a.monto_nacional) as devengado
        FROM presupuesto.expediente_meta as a 
        INNER JOIN (SELECT ano_eje, sec_ejec, expediente, ciclo, fase, secuencia, estado_envio, fuente_financ, tipo_recurso FROM presupuesto.expediente_fase        
        GROUP BY ano_eje, sec_ejec, expediente, ciclo, fase, secuencia, estado_envio, fuente_financ, tipo_recurso) as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.expediente = b.expediente AND a.ciclo = b.ciclo AND a.fase = b.fase AND a.secuencia = b.secuencia AND a.estado_envio = b.estado_envio)  
        WHERE a.estado_envio = 'A' AND a.ciclo = 'G' AND a.fase = 'D' AND a.sec_func != '0000' GROUP BY a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ, b.tipo_recurso)) as f3
        ON (g.ano_eje = f3.ano_eje AND g.sec_ejec = f3.sec_ejec AND g.sec_func = f3.sec_func AND g.id_clasificador = f3.id_clasificador AND g.fuente_financ = f3.fuente_financ 
        AND f2.tipo_recurso = f3.tipo_recurso)	
        LEFT JOIN ((SELECT a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ, b.tipo_recurso, SUM(a.monto_nacional) as girado
        FROM presupuesto.expediente_meta as a 
        INNER JOIN (SELECT ano_eje, sec_ejec, expediente, ciclo, fase, secuencia, estado_envio, fuente_financ, tipo_recurso FROM presupuesto.expediente_fase        
        GROUP BY ano_eje, sec_ejec, expediente, ciclo, fase, secuencia, estado_envio, fuente_financ, tipo_recurso) as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.expediente = b.expediente AND a.ciclo = b.ciclo AND a.fase = b.fase AND a.secuencia = b.secuencia AND a.estado_envio = b.estado_envio)  
        WHERE a.estado_envio = 'A' AND a.ciclo = 'G' AND a.fase = 'G' AND a.sec_func != '0000' GROUP BY a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ, b.tipo_recurso)) as f4
        ON (g.ano_eje = f4.ano_eje AND g.sec_ejec = f4.sec_ejec AND g.sec_func = f4.sec_func AND g.id_clasificador = f4.id_clasificador AND g.fuente_financ = f4.fuente_financ 
        AND f2.tipo_recurso = f4.tipo_recurso)        												
        LEFT JOIN ((SELECT a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ, b.tipo_recurso, SUM(a.monto_nacional) as pagado
        FROM presupuesto.expediente_meta as a 
        INNER JOIN (SELECT ano_eje, sec_ejec, expediente, ciclo, fase, secuencia, estado_envio, fuente_financ, tipo_recurso FROM presupuesto.expediente_fase        
        GROUP BY ano_eje, sec_ejec, expediente, ciclo, fase, secuencia, estado_envio, fuente_financ, tipo_recurso) as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.expediente = b.expediente AND a.ciclo = b.ciclo AND a.fase = b.fase AND a.secuencia = b.secuencia AND a.estado_envio = b.estado_envio)  
        WHERE a.estado_envio = 'A' AND a.ciclo = 'G' AND a.fase = 'P' AND a.sec_func != '0000' GROUP BY a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ, b.tipo_recurso)) as f5
        ON (g.ano_eje = f5.ano_eje AND g.sec_ejec = f5.sec_ejec AND g.sec_func = f5.sec_func AND g.id_clasificador = f5.id_clasificador AND g.fuente_financ = f5.fuente_financ 
        AND f2.tipo_recurso = f5.tipo_recurso)
        INNER JOIN presupuesto.fuente_financ as ru ON (g.ano_eje = ru.ano_eje AND g.fuente_financ = ru.fuente_financ AND ru.estado = 'A')
        INNER JOIN presupuesto.fuente_financ_agregada as fu ON (ru.ano_eje = fu.ano_eje AND ru.fuente_financ_agregada = fu.fuente_financ_agregada AND ru.estado = fu.estado)
        INNER JOIN presupuesto.especifica_det as ed ON (g.ano_eje = ed.ano_eje AND g.id_clasificador = ed.id_clasificador AND ed.estado= 'A')        
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_gasto as cg ON (sgd.ano_eje = cg.ano_eje AND sgd.categoria_gasto = cg.categ_gasto AND sgd.estado = cg.estado)        
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)        
        INNER JOIN presupuesto.tipo_recurso as tr ON (g.ano_eje = tr.ano_eje AND g.fuente_financ = tr.fuente_financ AND f2.tipo_recurso = tr.tipo_recurso AND tr.estado = 'A')        
        INNER JOIN presupuesto.meta as m ON (g.ano_eje = m.ano_eje AND g.sec_ejec = m.sec_ejec AND g.sec_func = m.sec_func AND m.estado = 'A')
        ${d} JOIN presupuesto.meta_centro_costo as mcc ON (m.ano_eje = mcc.ano_eje AND m.sec_ejec = mcc.sec_ejec AND m.sec_func = mcc.sec_func)
        ${d} JOIN presupuesto.centro_costo as cc ON (mcc.ceco_id = cc.ceco_id)
        INNER JOIN presupuesto.finalidad as fi ON (m.ano_eje = fi.ano_eje AND m.finalidad = fi.finalidad AND m.estado = fi.estado)
        INNER JOIN presupuesto.programa_ppto_nombre as cp ON (m.ano_eje = cp.ano_eje AND m.programa_ppto = cp.programa_ppto AND m.estado = cp.estado)
        INNER JOIN presupuesto.act_proy_nombre as ap ON (m.ano_eje = ap.ano_eje AND m.act_proy = ap.act_proy AND m.estado = ap.estado)
        INNER JOIN presupuesto.componente_nombre as co ON (m.ano_eje = co.ano_eje AND m.componente = co.componente AND m.estado = co.estado)
        INNER JOIN presupuesto.funcion as fn ON (m.ano_eje = fn.ano_eje AND m.funcion = fn.funcion AND m.estado = fn.estado)        
        INNER JOIN presupuesto.programa_nombre as pn ON (m.ano_eje = pn.ano_eje AND m.programa = pn.programa AND m.estado = pn.estado)
        INNER JOIN presupuesto.sub_programa_nombre as spn ON (m.ano_eje = spn.ano_eje AND m.sub_programa = spn.sub_programa AND m.estado = spn.estado)        
        INNER JOIN presupuesto.provincia as pr ON (m.departamento = pr.departamento AND m.provincia = pr.provincia AND m.estado = pr.estado)
        INNER JOIN presupuesto.distrito as di ON (m.departamento = di.departamento AND m.provincia = di.provincia AND m.distrito = di.distrito AND m.estado = di.estado) 
        INNER JOIN presupuesto.ejecutora as ej ON (g.ano_eje = ej.ano_eje AND g.sec_ejec = ej.sec_ejec AND ej.pliego = '459') ${c}  
    </select>
    
    <select id="getEjecucionMensualizada" parameterType="HashMap" resultMap="PresupuestoMap">
        SELECT me.mes, me.nombre, SUM(f1.certificado) as certificado, SUM(f2.compromiso_anual) as compromiso_anual, 
        SUM(f3.compromiso) as compromiso, SUM(f4.devengado) as devengado, SUM(f5.girado) as girado, SUM(f6.pagado) as pagado
        FROM utilitarios.meses as me                
        LEFT JOIN (SELECT a.ano_eje, a.sec_ejec, date_part('month', b.fecha_doc)::int as mes, SUM(a.monto_nacional) as certificado
        FROM presupuesto.certificado_meta as a
        INNER JOIN presupuesto.certificado_secuencia as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.certificado = b.certificado AND a.secuencia = b.secuencia 
        AND a.correlativo = b.correlativo AND a.estado_registro = b.estado_registro)
        INNER JOIN presupuesto.certificado_fase as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.certificado = c.certificado AND a.secuencia = c.secuencia 
        AND a.estado_registro = c.estado_registro)
        INNER JOIN presupuesto.fuente_financ as ru ON (a.ano_eje = ru.ano_eje AND c.fuente_financ = ru.fuente_financ AND ru.estado = 'A')
        INNER JOIN presupuesto.fuente_financ_agregada as fu ON (ru.ano_eje = fu.ano_eje AND ru.fuente_financ_agregada = fu.fuente_financ_agregada AND ru.estado = fu.estado)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')        
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_gasto as cg ON (sgd.ano_eje = cg.ano_eje AND sgd.categoria_gasto = cg.categ_gasto AND sgd.estado = cg.estado)        
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)
        INNER JOIN presupuesto.meta as m ON (a.ano_eje = m.ano_eje AND a.sec_ejec = m.sec_ejec AND a.sec_func = m.sec_func AND m.estado = 'A')
        LEFT JOIN presupuesto.meta_centro_costo as mcc ON (m.ano_eje = mcc.ano_eje AND m.sec_ejec = mcc.sec_ejec AND m.sec_func = mcc.sec_func)
        LEFT JOIN presupuesto.centro_costo as cc ON (mcc.ceco_id = cc.ceco_id)
        INNER JOIN presupuesto.finalidad as fi ON (m.ano_eje = fi.ano_eje AND m.finalidad = fi.finalidad AND m.estado = fi.estado)
        INNER JOIN presupuesto.programa_ppto_nombre as cp ON (m.ano_eje = cp.ano_eje AND m.programa_ppto = cp.programa_ppto AND m.estado = cp.estado)
        INNER JOIN presupuesto.act_proy_nombre as ap ON (m.ano_eje = ap.ano_eje AND m.act_proy = ap.act_proy AND m.estado = ap.estado)
        INNER JOIN presupuesto.componente_nombre as co ON (m.ano_eje = co.ano_eje AND m.componente = co.componente AND m.estado = co.estado)
        INNER JOIN presupuesto.funcion as fn ON (m.ano_eje = fn.ano_eje AND m.funcion = fn.funcion AND m.estado = fn.estado)
        INNER JOIN presupuesto.programa_nombre as pn ON (m.ano_eje = pn.ano_eje AND m.programa = pn.programa AND m.estado = pn.estado)
        INNER JOIN presupuesto.sub_programa_nombre as spn ON (m.ano_eje = spn.ano_eje AND m.sub_programa = spn.sub_programa AND m.estado = spn.estado)
        INNER JOIN presupuesto.provincia as pr ON (m.departamento = pr.departamento AND m.provincia = pr.provincia AND m.estado = pr.estado)
        INNER JOIN presupuesto.distrito as di ON (m.departamento = di.departamento AND m.provincia = di.provincia AND m.distrito = di.distrito AND m.estado = di.estado)
        WHERE ${c} AND a.estado_registro = 'A' AND a.sec_func != '0000' AND c.etapa = '1'
        GROUP BY a.ano_eje, a.sec_ejec, date_part('month', b.fecha_doc)::int) as f1 ON (me.mes = f1.mes)  
        LEFT JOIN (SELECT a.ano_eje, a.sec_ejec, date_part('month', b.fecha_doc)::int as mes, SUM(a.monto_nacional) as compromiso_anual
        FROM presupuesto.certificado_meta as a
        INNER JOIN presupuesto.certificado_secuencia as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.certificado = b.certificado AND a.secuencia = b.secuencia 
        AND a.correlativo = b.correlativo AND a.estado_registro = b.estado_registro)
        INNER JOIN presupuesto.certificado_fase as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.certificado = c.certificado AND a.secuencia = c.secuencia 
        AND a.estado_registro = c.estado_registro)
        INNER JOIN presupuesto.fuente_financ as ru ON (a.ano_eje = ru.ano_eje AND c.fuente_financ = ru.fuente_financ AND ru.estado = 'A')
        INNER JOIN presupuesto.fuente_financ_agregada as fu ON (ru.ano_eje = fu.ano_eje AND ru.fuente_financ_agregada = fu.fuente_financ_agregada AND ru.estado = fu.estado)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')        
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_gasto as cg ON (sgd.ano_eje = cg.ano_eje AND sgd.categoria_gasto = cg.categ_gasto AND sgd.estado = cg.estado)        
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)
        INNER JOIN presupuesto.meta as m ON (a.ano_eje = m.ano_eje AND a.sec_ejec = m.sec_ejec AND a.sec_func = m.sec_func AND m.estado = 'A')
        LEFT JOIN presupuesto.meta_centro_costo as mcc ON (m.ano_eje = mcc.ano_eje AND m.sec_ejec = mcc.sec_ejec AND m.sec_func = mcc.sec_func)
        LEFT JOIN presupuesto.centro_costo as cc ON (mcc.ceco_id = cc.ceco_id)
        INNER JOIN presupuesto.finalidad as fi ON (m.ano_eje = fi.ano_eje AND m.finalidad = fi.finalidad AND m.estado = fi.estado)
        INNER JOIN presupuesto.programa_ppto_nombre as cp ON (m.ano_eje = cp.ano_eje AND m.programa_ppto = cp.programa_ppto AND m.estado = cp.estado)
        INNER JOIN presupuesto.act_proy_nombre as ap ON (m.ano_eje = ap.ano_eje AND m.act_proy = ap.act_proy AND m.estado = ap.estado)
        INNER JOIN presupuesto.componente_nombre as co ON (m.ano_eje = co.ano_eje AND m.componente = co.componente AND m.estado = co.estado)
        INNER JOIN presupuesto.funcion as fn ON (m.ano_eje = fn.ano_eje AND m.funcion = fn.funcion AND m.estado = fn.estado)
        INNER JOIN presupuesto.programa_nombre as pn ON (m.ano_eje = pn.ano_eje AND m.programa = pn.programa AND m.estado = pn.estado)
        INNER JOIN presupuesto.sub_programa_nombre as spn ON (m.ano_eje = spn.ano_eje AND m.sub_programa = spn.sub_programa AND m.estado = spn.estado)
        INNER JOIN presupuesto.provincia as pr ON (m.departamento = pr.departamento AND m.provincia = pr.provincia AND m.estado = pr.estado)
        INNER JOIN presupuesto.distrito as di ON (m.departamento = di.departamento AND m.provincia = di.provincia AND m.distrito = di.distrito AND m.estado = di.estado)
        WHERE ${c} AND a.estado_registro = 'A' AND a.sec_func != '0000' AND c.etapa = '2'
        GROUP BY a.ano_eje, a.sec_ejec, date_part('month', b.fecha_doc)::int) as f2 ON (me.mes = f2.mes)       
        LEFT JOIN (SELECT a.ano_eje, a.sec_ejec, date_part('month', b.fecha_doc)::int as mes, SUM(a.monto_nacional) as compromiso
        FROM presupuesto.expediente_meta as a
        INNER JOIN presupuesto.expediente_secuencia as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.expediente = b.expediente AND a.ciclo = b.ciclo AND a.fase = b.fase 
        AND a.secuencia = b.secuencia AND a.correlativo = b.correlativo AND a.estado_envio = b.estado_envio)
        INNER JOIN presupuesto.expediente_fase as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.expediente = c.expediente AND a.ciclo = c.ciclo AND a.fase = c.fase 
        AND a.secuencia = c.secuencia AND a.estado_envio = c.estado_envio)
        INNER JOIN presupuesto.fuente_financ as ru ON (a.ano_eje = ru.ano_eje AND c.fuente_financ = ru.fuente_financ AND ru.estado = 'A')
        INNER JOIN presupuesto.fuente_financ_agregada as fu ON (ru.ano_eje = fu.ano_eje AND ru.fuente_financ_agregada = fu.fuente_financ_agregada AND ru.estado = fu.estado)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')        
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_gasto as cg ON (sgd.ano_eje = cg.ano_eje AND sgd.categoria_gasto = cg.categ_gasto AND sgd.estado = cg.estado)        
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)
        INNER JOIN presupuesto.meta as m ON (a.ano_eje = m.ano_eje AND a.sec_ejec = m.sec_ejec AND a.sec_func = m.sec_func AND m.estado = 'A')
        LEFT JOIN presupuesto.meta_centro_costo as mcc ON (m.ano_eje = mcc.ano_eje AND m.sec_ejec = mcc.sec_ejec AND m.sec_func = mcc.sec_func)
        LEFT JOIN presupuesto.centro_costo as cc ON (mcc.ceco_id = cc.ceco_id)
        INNER JOIN presupuesto.finalidad as fi ON (m.ano_eje = fi.ano_eje AND m.finalidad = fi.finalidad AND m.estado = fi.estado)
        INNER JOIN presupuesto.programa_ppto_nombre as cp ON (m.ano_eje = cp.ano_eje AND m.programa_ppto = cp.programa_ppto AND m.estado = cp.estado)
        INNER JOIN presupuesto.act_proy_nombre as ap ON (m.ano_eje = ap.ano_eje AND m.act_proy = ap.act_proy AND m.estado = ap.estado)
        INNER JOIN presupuesto.componente_nombre as co ON (m.ano_eje = co.ano_eje AND m.componente = co.componente AND m.estado = co.estado)
        INNER JOIN presupuesto.funcion as fn ON (m.ano_eje = fn.ano_eje AND m.funcion = fn.funcion AND m.estado = fn.estado)
        INNER JOIN presupuesto.programa_nombre as pn ON (m.ano_eje = pn.ano_eje AND m.programa = pn.programa AND m.estado = pn.estado)
        INNER JOIN presupuesto.sub_programa_nombre as spn ON (m.ano_eje = spn.ano_eje AND m.sub_programa = spn.sub_programa AND m.estado = spn.estado)
        INNER JOIN presupuesto.provincia as pr ON (m.departamento = pr.departamento AND m.provincia = pr.provincia AND m.estado = pr.estado)
        INNER JOIN presupuesto.distrito as di ON (m.departamento = di.departamento AND m.provincia = di.provincia AND m.distrito = di.distrito AND m.estado = di.estado)
        WHERE ${c} AND a.ciclo = 'G' AND a.fase = 'C' AND a.estado_envio = 'A' AND a.sec_func != '0000'
        GROUP BY a.ano_eje, a.sec_ejec, date_part('month', b.fecha_doc)::int) as f3 ON (me.mes = f3.mes)        
        LEFT JOIN (SELECT a.ano_eje, a.sec_ejec, date_part('month', b.fecha_doc)::int as mes, SUM(a.monto_nacional) as devengado
        FROM presupuesto.expediente_meta as a
        INNER JOIN presupuesto.expediente_secuencia as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.expediente = b.expediente AND a.ciclo = b.ciclo AND a.fase = b.fase 
        AND a.secuencia = b.secuencia AND a.correlativo = b.correlativo AND a.estado_envio = b.estado_envio)
        INNER JOIN presupuesto.expediente_fase as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.expediente = c.expediente AND a.ciclo = c.ciclo AND a.fase = c.fase 
        AND a.secuencia = c.secuencia AND a.estado_envio = c.estado_envio)
        INNER JOIN presupuesto.fuente_financ as ru ON (a.ano_eje = ru.ano_eje AND c.fuente_financ = ru.fuente_financ AND ru.estado = 'A')
        INNER JOIN presupuesto.fuente_financ_agregada as fu ON (ru.ano_eje = fu.ano_eje AND ru.fuente_financ_agregada = fu.fuente_financ_agregada AND ru.estado = fu.estado)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')        
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_gasto as cg ON (sgd.ano_eje = cg.ano_eje AND sgd.categoria_gasto = cg.categ_gasto AND sgd.estado = cg.estado)        
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)
        INNER JOIN presupuesto.meta as m ON (a.ano_eje = m.ano_eje AND a.sec_ejec = m.sec_ejec AND a.sec_func = m.sec_func AND m.estado = 'A')
        LEFT JOIN presupuesto.meta_centro_costo as mcc ON (m.ano_eje = mcc.ano_eje AND m.sec_ejec = mcc.sec_ejec AND m.sec_func = mcc.sec_func)
        LEFT JOIN presupuesto.centro_costo as cc ON (mcc.ceco_id = cc.ceco_id)
        INNER JOIN presupuesto.finalidad as fi ON (m.ano_eje = fi.ano_eje AND m.finalidad = fi.finalidad AND m.estado = fi.estado)
        INNER JOIN presupuesto.programa_ppto_nombre as cp ON (m.ano_eje = cp.ano_eje AND m.programa_ppto = cp.programa_ppto AND m.estado = cp.estado)
        INNER JOIN presupuesto.act_proy_nombre as ap ON (m.ano_eje = ap.ano_eje AND m.act_proy = ap.act_proy AND m.estado = ap.estado)
        INNER JOIN presupuesto.componente_nombre as co ON (m.ano_eje = co.ano_eje AND m.componente = co.componente AND m.estado = co.estado)
        INNER JOIN presupuesto.funcion as fn ON (m.ano_eje = fn.ano_eje AND m.funcion = fn.funcion AND m.estado = fn.estado)
        INNER JOIN presupuesto.programa_nombre as pn ON (m.ano_eje = pn.ano_eje AND m.programa = pn.programa AND m.estado = pn.estado)
        INNER JOIN presupuesto.sub_programa_nombre as spn ON (m.ano_eje = spn.ano_eje AND m.sub_programa = spn.sub_programa AND m.estado = spn.estado)
        INNER JOIN presupuesto.provincia as pr ON (m.departamento = pr.departamento AND m.provincia = pr.provincia AND m.estado = pr.estado)
        INNER JOIN presupuesto.distrito as di ON (m.departamento = di.departamento AND m.provincia = di.provincia AND m.distrito = di.distrito AND m.estado = di.estado)
        WHERE ${c} AND a.ciclo = 'G' AND a.fase = 'D' AND a.estado_envio = 'A' AND a.sec_func != '0000'
        GROUP BY a.ano_eje, a.sec_ejec, date_part('month', b.fecha_doc)::int) as f4 ON (me.mes = f4.mes)
        LEFT JOIN (SELECT a.ano_eje, a.sec_ejec, date_part('month', b.fecha_doc)::int as mes, SUM(a.monto_nacional) as girado
        FROM presupuesto.expediente_meta as a
        INNER JOIN presupuesto.expediente_secuencia as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.expediente = b.expediente AND a.ciclo = b.ciclo AND a.fase = b.fase 
        AND a.secuencia = b.secuencia AND a.correlativo = b.correlativo AND a.estado_envio = b.estado_envio)
        INNER JOIN presupuesto.expediente_fase as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.expediente = c.expediente AND a.ciclo = c.ciclo AND a.fase = c.fase 
        AND a.secuencia = c.secuencia AND a.estado_envio = c.estado_envio)
        INNER JOIN presupuesto.fuente_financ as ru ON (a.ano_eje = ru.ano_eje AND c.fuente_financ = ru.fuente_financ AND ru.estado = 'A')
        INNER JOIN presupuesto.fuente_financ_agregada as fu ON (ru.ano_eje = fu.ano_eje AND ru.fuente_financ_agregada = fu.fuente_financ_agregada AND ru.estado = fu.estado)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')        
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_gasto as cg ON (sgd.ano_eje = cg.ano_eje AND sgd.categoria_gasto = cg.categ_gasto AND sgd.estado = cg.estado)        
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)
        INNER JOIN presupuesto.meta as m ON (a.ano_eje = m.ano_eje AND a.sec_ejec = m.sec_ejec AND a.sec_func = m.sec_func AND m.estado = 'A')
        LEFT JOIN presupuesto.meta_centro_costo as mcc ON (m.ano_eje = mcc.ano_eje AND m.sec_ejec = mcc.sec_ejec AND m.sec_func = mcc.sec_func)
        LEFT JOIN presupuesto.centro_costo as cc ON (mcc.ceco_id = cc.ceco_id)
        INNER JOIN presupuesto.finalidad as fi ON (m.ano_eje = fi.ano_eje AND m.finalidad = fi.finalidad AND m.estado = fi.estado)
        INNER JOIN presupuesto.programa_ppto_nombre as cp ON (m.ano_eje = cp.ano_eje AND m.programa_ppto = cp.programa_ppto AND m.estado = cp.estado)
        INNER JOIN presupuesto.act_proy_nombre as ap ON (m.ano_eje = ap.ano_eje AND m.act_proy = ap.act_proy AND m.estado = ap.estado)
        INNER JOIN presupuesto.componente_nombre as co ON (m.ano_eje = co.ano_eje AND m.componente = co.componente AND m.estado = co.estado)
        INNER JOIN presupuesto.funcion as fn ON (m.ano_eje = fn.ano_eje AND m.funcion = fn.funcion AND m.estado = fn.estado)
        INNER JOIN presupuesto.programa_nombre as pn ON (m.ano_eje = pn.ano_eje AND m.programa = pn.programa AND m.estado = pn.estado)
        INNER JOIN presupuesto.sub_programa_nombre as spn ON (m.ano_eje = spn.ano_eje AND m.sub_programa = spn.sub_programa AND m.estado = spn.estado)
        INNER JOIN presupuesto.provincia as pr ON (m.departamento = pr.departamento AND m.provincia = pr.provincia AND m.estado = pr.estado)
        INNER JOIN presupuesto.distrito as di ON (m.departamento = di.departamento AND m.provincia = di.provincia AND m.distrito = di.distrito AND m.estado = di.estado)
        WHERE ${c} AND a.ciclo = 'G' AND a.fase = 'G' AND a.estado_envio = 'A' AND a.sec_func != '0000'
        GROUP BY a.ano_eje, a.sec_ejec, date_part('month', b.fecha_doc)::int) as f5 ON (me.mes = f5.mes)
        LEFT JOIN (SELECT a.ano_eje, a.sec_ejec, date_part('month', b.fecha_doc)::int as mes, SUM(a.monto_nacional) as pagado
        FROM presupuesto.expediente_meta as a
        INNER JOIN presupuesto.expediente_secuencia as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.expediente = b.expediente AND a.ciclo = b.ciclo AND a.fase = b.fase 
        AND a.secuencia = b.secuencia AND a.correlativo = b.correlativo AND a.estado_envio = b.estado_envio)
        INNER JOIN presupuesto.expediente_fase as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.expediente = c.expediente AND a.ciclo = c.ciclo AND a.fase = c.fase 
        AND a.secuencia = c.secuencia AND a.estado_envio = c.estado_envio)
        INNER JOIN presupuesto.fuente_financ as ru ON (a.ano_eje = ru.ano_eje AND c.fuente_financ = ru.fuente_financ AND ru.estado = 'A')
        INNER JOIN presupuesto.fuente_financ_agregada as fu ON (ru.ano_eje = fu.ano_eje AND ru.fuente_financ_agregada = fu.fuente_financ_agregada AND ru.estado = fu.estado)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')        
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_gasto as cg ON (sgd.ano_eje = cg.ano_eje AND sgd.categoria_gasto = cg.categ_gasto AND sgd.estado = cg.estado)        
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)
        INNER JOIN presupuesto.meta as m ON (a.ano_eje = m.ano_eje AND a.sec_ejec = m.sec_ejec AND a.sec_func = m.sec_func AND m.estado = 'A')
        LEFT JOIN presupuesto.meta_centro_costo as mcc ON (m.ano_eje = mcc.ano_eje AND m.sec_ejec = mcc.sec_ejec AND m.sec_func = mcc.sec_func)
        LEFT JOIN presupuesto.centro_costo as cc ON (mcc.ceco_id = cc.ceco_id)
        INNER JOIN presupuesto.finalidad as fi ON (m.ano_eje = fi.ano_eje AND m.finalidad = fi.finalidad AND m.estado = fi.estado)
        INNER JOIN presupuesto.programa_ppto_nombre as cp ON (m.ano_eje = cp.ano_eje AND m.programa_ppto = cp.programa_ppto AND m.estado = cp.estado)
        INNER JOIN presupuesto.act_proy_nombre as ap ON (m.ano_eje = ap.ano_eje AND m.act_proy = ap.act_proy AND m.estado = ap.estado)
        INNER JOIN presupuesto.componente_nombre as co ON (m.ano_eje = co.ano_eje AND m.componente = co.componente AND m.estado = co.estado)
        INNER JOIN presupuesto.funcion as fn ON (m.ano_eje = fn.ano_eje AND m.funcion = fn.funcion AND m.estado = fn.estado)
        INNER JOIN presupuesto.programa_nombre as pn ON (m.ano_eje = pn.ano_eje AND m.programa = pn.programa AND m.estado = pn.estado)
        INNER JOIN presupuesto.sub_programa_nombre as spn ON (m.ano_eje = spn.ano_eje AND m.sub_programa = spn.sub_programa AND m.estado = spn.estado)
        INNER JOIN presupuesto.provincia as pr ON (m.departamento = pr.departamento AND m.provincia = pr.provincia AND m.estado = pr.estado)
        INNER JOIN presupuesto.distrito as di ON (m.departamento = di.departamento AND m.provincia = di.provincia AND m.distrito = di.distrito AND m.estado = di.estado)
        WHERE ${c} AND a.ciclo = 'G' AND a.fase = 'P' AND a.estado_envio = 'A' AND a.sec_func != '0000'
        GROUP BY a.ano_eje, a.sec_ejec, date_part('month', b.fecha_doc)::int) as f6 ON (me.mes = f6.mes)
        GROUP BY me.mes, me.nombre ORDER BY me.mes ASC
    </select>
    
    <select id="getCertificaciones" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT f1.certificacion, fu.fuente_financ_agregada, trim(fu.nombre) as nombre_fuente_financ_agregada, trim(f1.glosa) as glosa, ${b} 
        SUM(f1.certificado) as certificado, SUM(f1.compromiso_anual) as compromiso_anual, SUM(f2.compromiso) as compromiso, 
        SUM(f3.devengado) as devengado, SUM(f4.girado) as girado, SUM(f5.pagado) as pagado
        FROM (SELECT a.ano_eje, a.sec_ejec, a.certificacion, a.glosa, a.sec_func, a.id_clasificador, a.fuente_financ, a.certificado, b.total - a.certificado as compromiso_anual
        FROM (SELECT a.ano_eje, a.sec_ejec, a.certificado as certificacion, a.glosa, b.sec_func, b.id_clasificador, a.fuente_financ, SUM(b.monto) as certificado
        FROM presupuesto.certificado_fase as a INNER JOIN presupuesto.certificado_meta as b 
        ON (a.ano_eje=b.ano_eje AND a.sec_ejec=b.sec_ejec AND a.certificado=b.certificado AND a.secuencia=b.secuencia AND a.estado_registro=b.estado_registro) 
        WHERE a.secuencia_padre = '0000' AND a.estado_registro = 'A'
        GROUP BY a.ano_eje, a.sec_ejec, a.certificado, a.glosa, b.sec_func, b.id_clasificador, a.fuente_financ) as a        
        INNER JOIN (SELECT a.ano_eje, a.sec_ejec, a.certificado as certificacion, b.sec_func, b.id_clasificador, a.fuente_financ, SUM(b.monto) as total
        FROM presupuesto.certificado_fase as a INNER JOIN presupuesto.certificado_meta as b 
        ON (a.ano_eje=b.ano_eje AND a.sec_ejec=b.sec_ejec AND a.certificado=b.certificado AND a.secuencia=b.secuencia AND a.estado_registro=b.estado_registro) 
        WHERE a.estado_registro = 'A' GROUP BY a.ano_eje, a.sec_ejec, a.certificado, b.sec_func, b.id_clasificador, a.fuente_financ) as b 
        ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.certificacion = b.certificacion AND a.sec_func = b.sec_func AND a.id_clasificador = b.id_clasificador AND a.fuente_financ = b.fuente_financ)) as f1
        LEFT JOIN ((SELECT a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ, b.certificado as certificacion, SUM(a.monto_nacional) as compromiso
        FROM presupuesto.expediente_meta as a INNER JOIN (SELECT ano_eje, sec_ejec, expediente, fuente_financ, certificado FROM presupuesto.expediente_fase
        WHERE ciclo = 'G' AND fase = 'C'  AND estado_envio = 'A' 
        GROUP BY ano_eje, sec_ejec, expediente, fuente_financ, certificado) as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.expediente = b.expediente)
        WHERE a.estado_envio = 'A' AND a.ciclo = 'G' AND a.fase = 'C' GROUP BY a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ, b.certificado)) as f2
        ON (f1.ano_eje = f2.ano_eje AND f1.sec_ejec = f2.sec_ejec AND f1.certificacion = f2.certificacion AND f1.sec_func = f2.sec_func AND f1.id_clasificador = f2.id_clasificador AND f1.fuente_financ = f2.fuente_financ)
        LEFT JOIN ((SELECT a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ, b.certificado as certificacion, SUM(a.monto_nacional) as devengado
        FROM presupuesto.expediente_meta as a INNER JOIN (SELECT ano_eje, sec_ejec, expediente, fuente_financ, certificado FROM presupuesto.expediente_fase
        WHERE ciclo = 'G' AND fase = 'D'  AND estado_envio = 'A' 
        GROUP BY ano_eje, sec_ejec, expediente, fuente_financ, certificado) as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.expediente = b.expediente)
        WHERE a.estado_envio = 'A' AND a.ciclo = 'G' AND a.fase = 'D' GROUP BY a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ, b.certificado)) as f3
        ON (f1.ano_eje = f3.ano_eje AND f1.sec_ejec = f3.sec_ejec AND f1.certificacion = f3.certificacion AND f1.sec_func = f3.sec_func AND f1.id_clasificador = f3.id_clasificador AND f1.fuente_financ = f3.fuente_financ)
        LEFT JOIN ((SELECT a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ, b.certificado as certificacion, SUM(a.monto_nacional) as girado
        FROM presupuesto.expediente_meta as a INNER JOIN (SELECT ano_eje, sec_ejec, expediente, fuente_financ, certificado FROM presupuesto.expediente_fase
        WHERE ciclo = 'G' AND fase = 'G'  AND estado_envio = 'A' 
        GROUP BY ano_eje, sec_ejec, expediente, fuente_financ, certificado) as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.expediente = b.expediente)
        WHERE a.estado_envio = 'A' AND a.ciclo = 'G' AND a.fase = 'G' GROUP BY a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ, b.certificado)) as f4
        ON (f1.ano_eje = f4.ano_eje AND f1.sec_ejec = f4.sec_ejec AND f1.certificacion = f4.certificacion AND f1.sec_func = f4.sec_func AND f1.id_clasificador = f4.id_clasificador AND f1.fuente_financ = f4.fuente_financ)
        LEFT JOIN ((SELECT a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ, b.certificado as certificacion, SUM(a.monto_nacional) as pagado
        FROM presupuesto.expediente_meta as a INNER JOIN (SELECT ano_eje, sec_ejec, expediente, fuente_financ, certificado FROM presupuesto.expediente_fase
        WHERE ciclo = 'G' AND fase = 'P'  AND estado_envio = 'A' 
        GROUP BY ano_eje, sec_ejec, expediente, fuente_financ, certificado) as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.expediente = b.expediente)
        WHERE a.estado_envio = 'A' AND a.ciclo = 'G' AND a.fase = 'P' GROUP BY a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ, b.certificado)) as f5
        ON (f1.ano_eje = f5.ano_eje AND f1.sec_ejec = f5.sec_ejec AND f1.certificacion = f5.certificacion AND f1.sec_func = f5.sec_func AND f1.id_clasificador = f5.id_clasificador AND f1.fuente_financ = f5.fuente_financ)										
        INNER JOIN presupuesto.fuente_financ as ru ON (f1.ano_eje = ru.ano_eje AND f1.fuente_financ = ru.fuente_financ AND ru.estado = 'A')
        INNER JOIN presupuesto.fuente_financ_agregada as fu ON (ru.ano_eje = fu.ano_eje AND ru.fuente_financ_agregada = fu.fuente_financ_agregada AND ru.estado = fu.estado)
        INNER JOIN presupuesto.especifica_det as ed ON (f1.ano_eje = ed.ano_eje AND f1.id_clasificador = ed.id_clasificador AND ed.estado= 'A')        
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_gasto as cg ON (sgd.ano_eje = cg.ano_eje AND sgd.categoria_gasto = cg.categ_gasto AND sgd.estado = cg.estado)        
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)        
        INNER JOIN presupuesto.meta as m ON (f1.ano_eje = m.ano_eje AND f1.sec_ejec = m.sec_ejec AND f1.sec_func = m.sec_func AND m.estado = 'A')
        INNER JOIN presupuesto.finalidad as fi ON (m.ano_eje = fi.ano_eje AND m.finalidad = fi.finalidad AND m.estado = fi.estado)        
        INNER JOIN presupuesto.provincia as pr ON (m.departamento = pr.departamento AND m.provincia = pr.provincia AND m.estado = pr.estado) 
        INNER JOIN presupuesto.distrito as di ON (m.departamento = di.departamento AND m.provincia = di.provincia AND m.distrito = di.distrito AND m.estado = di.estado) ${c}  
    </select>
    
    <select id="getListSemaforoEjecucion" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT b.ejecutora, trim(b.nombre) as nombre, b.sec_ejec, a.pia, a.modificacion, a.pim, a.certificado, a.compromiso_anual, 
        a.compromiso, a.ejecucion, a.devengado, a.girado, a.pagado
        FROM presupuesto.ejecucion_historica as a
        INNER JOIN presupuesto.ejecutora as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec) ${c}  
    </select>
    
    <select id="getListSemaforoEjecucionMeta" parameterType="HashMap" resultMap="PresupuestoMap">
        SELECT a.sec_func, a.nombre, a.ceco_nombre, a.pim, a.certificado, a.ejecucion                
        FROM      
        (SELECT m.sec_func, trim(fi.nombre) as nombre, cc.ceco_nombre, 
        (CASE WHEN SUM(g.presupuesto) + SUM(g.modificacion) IS NULL THEN 0.00
        ELSE SUM(g.presupuesto) + SUM(g.modificacion) END) as pim,
        (CASE WHEN SUM(f1.certificado) IS NULL THEN 0.00
        ELSE SUM(f1.certificado) END) as certificado,
        (CASE WHEN SUM(f3.devengado) IS NULL THEN 0.00
        ELSE SUM(f3.devengado) END) as ejecucion 
        FROM presupuesto.gasto as g         
        LEFT JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, a.fuente_financ, a.certificado, b.total - a.certificado as compromiso_anual
        FROM (SELECT a.ano_eje, a.sec_ejec, b.sec_func, b.id_clasificador, a.fuente_financ, SUM(b.monto_nacional) as certificado
        FROM presupuesto.certificado_fase as a INNER JOIN presupuesto.certificado_meta as b 
        ON (a.ano_eje=b.ano_eje AND a.sec_ejec=b.sec_ejec AND a.certificado=b.certificado AND a.secuencia=b.secuencia AND a.estado_registro=b.estado_registro) 
        WHERE a.secuencia_padre = '0000' AND a.estado_registro = 'A'
        GROUP BY a.ano_eje, a.sec_ejec, b.sec_func, b.id_clasificador, a.fuente_financ) as a
        INNER JOIN (SELECT a.ano_eje, a.sec_ejec, b.sec_func, b.id_clasificador, a.fuente_financ, SUM(b.monto_nacional) as total
        FROM presupuesto.certificado_fase as a INNER JOIN presupuesto.certificado_meta as b 
        ON (a.ano_eje=b.ano_eje AND a.sec_ejec=b.sec_ejec AND a.certificado=b.certificado AND a.secuencia=b.secuencia AND a.estado_registro=b.estado_registro) 
        WHERE a.estado_registro = 'A' GROUP BY a.ano_eje, a.sec_ejec, b.sec_func, b.id_clasificador, a.fuente_financ) as b 
        ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_func = b.sec_func AND a.id_clasificador = b.id_clasificador AND a.fuente_financ = b.fuente_financ)) as f1
        ON (g.ano_eje = f1.ano_eje AND g.sec_ejec = f1.sec_ejec AND g.sec_func = f1.sec_func AND g.id_clasificador = f1.id_clasificador AND g.fuente_financ = f1.fuente_financ)		        						
        LEFT JOIN ((SELECT a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ, SUM(a.monto_nacional) as devengado
        FROM presupuesto.expediente_meta as a INNER JOIN (SELECT ano_eje, sec_ejec, expediente, ciclo, fase, secuencia, estado_envio, fuente_financ
        FROM presupuesto.expediente_fase GROUP BY ano_eje, sec_ejec, expediente, ciclo, fase, secuencia, estado_envio, fuente_financ) as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.expediente = b.expediente AND a.ciclo = b.ciclo AND a.fase = b.fase AND a.secuencia = b.secuencia AND a.estado_envio = b.estado_envio)  
        WHERE a.estado_envio = 'A' AND a.ciclo = 'G' AND a.fase = 'D' AND a.sec_func != '0000' GROUP BY a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ)) as f3
        ON (g.ano_eje = f3.ano_eje AND g.sec_ejec = f3.sec_ejec AND g.sec_func = f3.sec_func AND g.id_clasificador = f3.id_clasificador AND g.fuente_financ = f3.fuente_financ)	                
        INNER JOIN presupuesto.meta as m ON (g.ano_eje = m.ano_eje AND g.sec_ejec = m.sec_ejec AND g.sec_func = m.sec_func AND m.estado = 'A')        
        LEFT JOIN presupuesto.meta_centro_costo as mcc ON (m.ano_eje = mcc.ano_eje AND m.sec_ejec = mcc.sec_ejec AND m.sec_func = mcc.sec_func)
        LEFT JOIN presupuesto.centro_costo as cc ON (mcc.ceco_id = cc.ceco_id)
        INNER JOIN presupuesto.finalidad as fi ON (m.ano_eje = fi.ano_eje AND m.finalidad = fi.finalidad AND m.estado = fi.estado) ${c} ) as a ${d}
    </select>
    
    <select id="getListDocuCerti" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT a.cod_doc, trim(b.nombre) as nombre 
        FROM presupuesto.certificado_secuencia as a
        INNER JOIN presupuesto.maestro_documento as b ON (a.cod_doc = b.cod_doc)
        INNER JOIN presupuesto.certificado_fase as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND 
        a.certificado = c.certificado AND a.secuencia = c.secuencia AND a.estado_registro = c.estado_registro) ${c}
    </select>    
    
    <select id="getCertificacionDetallada" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT f1.certificacion, fu.fuente_financ_agregada, trim(fu.nombre) as nombre_fuente_financ_agregada, trim(f1.glosa) as glosa, m.sec_func, 
        trim(fi.nombre) as nombre_sec_func, ed.clasificador, trim(ed.descripcion) as descripcion, ed.tipo_transaccion, ed.generica, ed.subgenerica, 
        ed.subgenerica_det, ed.especifica, ed.especifica_det, SUM(f1.certificado) as certificado, SUM(f1.compromiso_anual) as compromiso_anual, 
        SUM(f2.compromiso) as compromiso, SUM(f3.devengado) as devengado, SUM(f4.girado) as girado, SUM(f5.pagado) as pagado
        FROM (SELECT a.ano_eje, a.sec_ejec, a.certificacion, a.glosa, a.sec_func, a.id_clasificador, a.fuente_financ, a.certificado, b.total - a.certificado as compromiso_anual
        FROM (SELECT a.ano_eje, a.sec_ejec, a.certificado as certificacion, a.glosa, b.sec_func, b.id_clasificador, a.fuente_financ, SUM(b.monto) as certificado
        FROM presupuesto.certificado_fase as a INNER JOIN presupuesto.certificado_meta as b 
        ON (a.ano_eje=b.ano_eje AND a.sec_ejec=b.sec_ejec AND a.certificado=b.certificado AND a.secuencia=b.secuencia AND a.estado_registro=b.estado_registro) 
        WHERE a.secuencia_padre = '0000' AND a.estado_registro = 'A'
        GROUP BY a.ano_eje, a.sec_ejec, a.certificado, a.glosa, b.sec_func, b.id_clasificador, a.fuente_financ) as a        
        INNER JOIN (SELECT a.ano_eje, a.sec_ejec, a.certificado as certificacion, b.sec_func, b.id_clasificador, a.fuente_financ, SUM(b.monto) as total
        FROM presupuesto.certificado_fase as a INNER JOIN presupuesto.certificado_meta as b 
        ON (a.ano_eje=b.ano_eje AND a.sec_ejec=b.sec_ejec AND a.certificado=b.certificado AND a.secuencia=b.secuencia AND a.estado_registro=b.estado_registro) 
        WHERE a.estado_registro = 'A' GROUP BY a.ano_eje, a.sec_ejec, a.certificado, b.sec_func, b.id_clasificador, a.fuente_financ) as b 
        ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.certificacion = b.certificacion AND a.sec_func = b.sec_func AND a.id_clasificador = b.id_clasificador AND a.fuente_financ = b.fuente_financ)) as f1
        LEFT JOIN ((SELECT a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ, b.certificado as certificacion, SUM(a.monto_nacional) as compromiso
        FROM presupuesto.expediente_meta as a INNER JOIN (SELECT ano_eje, sec_ejec, expediente, fuente_financ, certificado FROM presupuesto.expediente_fase
        WHERE ciclo = 'G' AND fase = 'C'  AND estado_envio = 'A' 
        GROUP BY ano_eje, sec_ejec, expediente, fuente_financ, certificado) as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.expediente = b.expediente)
        WHERE a.estado_envio = 'A' AND a.ciclo = 'G' AND a.fase = 'C' GROUP BY a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ, b.certificado)) as f2
        ON (f1.ano_eje = f2.ano_eje AND f1.sec_ejec = f2.sec_ejec AND f1.certificacion = f2.certificacion AND f1.sec_func = f2.sec_func AND f1.id_clasificador = f2.id_clasificador AND f1.fuente_financ = f2.fuente_financ)
        LEFT JOIN ((SELECT a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ, b.certificado as certificacion, SUM(a.monto_nacional) as devengado
        FROM presupuesto.expediente_meta as a INNER JOIN (SELECT ano_eje, sec_ejec, expediente, fuente_financ, certificado FROM presupuesto.expediente_fase
        WHERE ciclo = 'G' AND fase = 'D'  AND estado_envio = 'A' 
        GROUP BY ano_eje, sec_ejec, expediente, fuente_financ, certificado) as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.expediente = b.expediente)
        WHERE a.estado_envio = 'A' AND a.ciclo = 'G' AND a.fase = 'D' GROUP BY a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ, b.certificado)) as f3
        ON (f1.ano_eje = f3.ano_eje AND f1.sec_ejec = f3.sec_ejec AND f1.certificacion = f3.certificacion AND f1.sec_func = f3.sec_func AND f1.id_clasificador = f3.id_clasificador AND f1.fuente_financ = f3.fuente_financ)
        LEFT JOIN ((SELECT a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ, b.certificado as certificacion, SUM(a.monto_nacional) as girado
        FROM presupuesto.expediente_meta as a INNER JOIN (SELECT ano_eje, sec_ejec, expediente, fuente_financ, certificado FROM presupuesto.expediente_fase
        WHERE ciclo = 'G' AND fase = 'G'  AND estado_envio = 'A' 
        GROUP BY ano_eje, sec_ejec, expediente, fuente_financ, certificado) as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.expediente = b.expediente)
        WHERE a.estado_envio = 'A' AND a.ciclo = 'G' AND a.fase = 'G' GROUP BY a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ, b.certificado)) as f4
        ON (f1.ano_eje = f4.ano_eje AND f1.sec_ejec = f4.sec_ejec AND f1.certificacion = f4.certificacion AND f1.sec_func = f4.sec_func AND f1.id_clasificador = f4.id_clasificador AND f1.fuente_financ = f4.fuente_financ)
        LEFT JOIN ((SELECT a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ, b.certificado as certificacion, SUM(a.monto_nacional) as pagado
        FROM presupuesto.expediente_meta as a INNER JOIN (SELECT ano_eje, sec_ejec, expediente, fuente_financ, certificado FROM presupuesto.expediente_fase
        WHERE ciclo = 'G' AND fase = 'P'  AND estado_envio = 'A' 
        GROUP BY ano_eje, sec_ejec, expediente, fuente_financ, certificado) as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.expediente = b.expediente)
        WHERE a.estado_envio = 'A' AND a.ciclo = 'G' AND a.fase = 'P' GROUP BY a.ano_eje, a.sec_ejec, a.sec_func, a.id_clasificador, b.fuente_financ, b.certificado)) as f5
        ON (f1.ano_eje = f5.ano_eje AND f1.sec_ejec = f5.sec_ejec AND f1.certificacion = f5.certificacion AND f1.sec_func = f5.sec_func AND f1.id_clasificador = f5.id_clasificador AND f1.fuente_financ = f5.fuente_financ)					
        INNER JOIN presupuesto.fuente_financ as ru ON (f1.ano_eje = ru.ano_eje AND f1.fuente_financ = ru.fuente_financ AND ru.estado = 'A')
        INNER JOIN presupuesto.fuente_financ_agregada as fu ON (ru.ano_eje = fu.ano_eje AND ru.fuente_financ_agregada = fu.fuente_financ_agregada AND ru.estado = fu.estado)
        INNER JOIN presupuesto.especifica_det as ed ON (f1.ano_eje = ed.ano_eje AND f1.id_clasificador = ed.id_clasificador AND ed.estado= 'A')              
        INNER JOIN presupuesto.meta as m ON (f1.ano_eje = m.ano_eje AND f1.sec_ejec = m.sec_ejec AND f1.sec_func = m.sec_func AND m.estado = 'A')
        INNER JOIN presupuesto.finalidad as fi ON (m.ano_eje = fi.ano_eje AND m.finalidad = fi.finalidad AND m.estado = fi.estado) ${c}  
    </select>  
    
    <select id="getCertificacionExpedientes" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT a.expediente, trim(fa.nombre) as fase, a.sec_func, trim(fi.nombre) as nombre, ed.clasificador, trim(ed.descripcion) as descripcion, a.monto_nacional as monto
        FROM presupuesto.expediente_meta as a
        INNER JOIN presupuesto.expediente_fase as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.expediente = b.expediente 
        AND a.ciclo = b.ciclo AND a.fase = b.fase AND a.secuencia = b.secuencia AND a.estado_envio = b.estado_envio)
        INNER JOIN presupuesto.fase as fa ON (a.ciclo = fa.ciclo AND a.fase = fa.fase)
        INNER JOIN presupuesto.meta as m ON (a.ano_eje = m.ano_eje AND a.sec_ejec = m.sec_ejec AND a.sec_func = m.sec_func AND m.estado = 'A')
        INNER JOIN presupuesto.finalidad as fi ON (m.ano_eje = fi.ano_eje AND m.finalidad = fi.finalidad AND m.estado = fi.estado)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A') ${c} 
    </select>  
    
    <select id="getCertificacionHistorial" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT a.certificado as certificacion, a.secuencia, a.correlativo, b.fecha_doc, fu.fuente_financ_agregada, trim(fu.nombre) as nombre_fuente_financ_agregada, 
        m.sec_func, trim(fi.nombre) as nombre_sec_func, ed.clasificador, trim(ed.descripcion) as descripcion, a.monto_nacional as monto, 
        trim(md.nombre) as nombre_documento, b.num_doc, b.tipo_registro, trim(c.glosa) as glosa, c.etapa
        FROM presupuesto.certificado_meta as a
        INNER JOIN presupuesto.certificado_secuencia as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.certificado = b.certificado 
        AND a.secuencia = b.secuencia AND a.correlativo = b.correlativo AND a.estado_registro = b.estado_registro)
        INNER JOIN presupuesto.certificado_fase as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.certificado = c.certificado 
        AND a.secuencia = c.secuencia AND a.estado_registro = c.estado_registro)
        INNER JOIN presupuesto.fuente_financ as ru ON (c.ano_eje = ru.ano_eje AND c.fuente_financ = ru.fuente_financ AND ru.estado = 'A')
        INNER JOIN presupuesto.fuente_financ_agregada as fu ON (ru.ano_eje = fu.ano_eje AND ru.fuente_financ_agregada = fu.fuente_financ_agregada AND ru.estado = fu.estado)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')              
        INNER JOIN presupuesto.meta as m ON (a.ano_eje = m.ano_eje AND a.sec_ejec = m.sec_ejec AND a.sec_func = m.sec_func AND m.estado = 'A')
        INNER JOIN presupuesto.finalidad as fi ON (m.ano_eje = fi.ano_eje AND m.finalidad = fi.finalidad AND m.estado = fi.estado)
        INNER JOIN presupuesto.maestro_documento as md ON (b.cod_doc = md.cod_doc) ${c}
    </select> 
    
    <select id="getCertificacionEstado" parameterType="HashMap" resultMap="PresupuestoMap">      
        SELECT a.certificado as certificacion, fu.fuente_financ_agregada, trim(fu.nombre) as nombre_fuente_financ_agregada, a.fecha_doc, 
        trim(md.nombre) as nombre_documento, a.num_doc, a.monto_nacional as monto, a.tipo_registro, a.estado_registro, a.estado_envio
        FROM presupuesto.certificado_secuencia as a 
        INNER JOIN presupuesto.certificado_fase as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.certificado = b.certificado 
        AND a.secuencia = b.secuencia AND a.estado_registro = b.estado_registro)
        INNER JOIN presupuesto.fuente_financ as ru ON (b.ano_eje = ru.ano_eje AND b.fuente_financ = ru.fuente_financ AND ru.estado = 'A')
        INNER JOIN presupuesto.fuente_financ_agregada as fu ON (ru.ano_eje = fu.ano_eje AND ru.fuente_financ_agregada = fu.fuente_financ_agregada AND ru.estado = fu.estado)
        INNER JOIN presupuesto.maestro_documento as md ON (a.cod_doc = md.cod_doc) ${c}
    </select> 
    
    <select id="getRecaudacionAnual" parameterType="HashMap" resultMap="PresupuestoMap">
        SELECT ${a} SUM(f1.pia) as pia, SUM(f1.modificacion) as modificacion, SUM(f1.pim) as pim, SUM(f1.recaudado) as recaudado 
        FROM (SELECT ${b} i.pia as pia, i.modificacion as modificacion, i.pim as pim, SUM(f1.recaudado) as recaudado               		
        FROM (SELECT a.ano_eje, a.sec_ejec, a.id_clasificador, c.fuente_financ, c.tipo_recurso, b.ano_cta_cte, b.banco, b.cta_cte, SUM(a.monto_nacional) as recaudado
        FROM presupuesto.expediente_ingreso as a 
        INNER JOIN presupuesto.expediente_secuencia as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.expediente = b.expediente AND a.ciclo = b.ciclo AND 
        a.fase = b.fase AND a.secuencia = b.secuencia AND a.correlativo = b.correlativo AND a.estado_envio = b.estado_envio)
        INNER JOIN presupuesto.expediente_fase as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.expediente = c.expediente AND a.ciclo = c.ciclo AND 
        a.fase = c.fase AND a.secuencia = c.secuencia AND a.estado_envio = c.estado_envio)
        WHERE a.ciclo = 'I' AND a.fase = 'R' AND a.estado_envio = 'A' AND a.id_clasificador != 'AAAAAAA' 
        GROUP BY a.ano_eje, a.sec_ejec, a.id_clasificador, c.fuente_financ, c.tipo_recurso, b.ano_cta_cte, b.banco, b.cta_cte) as f1        				
        INNER JOIN presupuesto.fuente_financ as ru ON (f1.ano_eje = ru.ano_eje AND f1.fuente_financ = ru.fuente_financ AND ru.estado = 'A')
        INNER JOIN presupuesto.fuente_financ_agregada as fu ON (ru.ano_eje = fu.ano_eje AND ru.fuente_financ_agregada = fu.fuente_financ_agregada AND ru.estado = fu.estado)        
        INNER JOIN presupuesto.especifica_det as ed ON (f1.ano_eje = ed.ano_eje AND f1.id_clasificador = ed.id_clasificador AND ed.estado= 'A')  
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)        
        INNER JOIN presupuesto.categoria_ingreso as ci ON (sgd.ano_eje = ci.ano_eje AND sgd.categoria_ingreso = ci.categoria_ingreso AND sgd.estado = ci.estado)   
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)               
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)                
        INNER JOIN presupuesto.tipo_recurso as tr ON (f1.ano_eje = tr.ano_eje AND f1.fuente_financ = tr.fuente_financ AND f1.tipo_recurso = tr.tipo_recurso AND tr.estado = 'A')                 
        INNER JOIN presupuesto.banco as b ON (f1.banco = b.banco AND b.estado = 'A')                 
        INNER JOIN presupuesto.cta_cte as cc ON (f1.sec_ejec = cc.sec_ejec AND f1.ano_cta_cte = cc.ano_eje AND f1.banco = cc.banco AND f1.cta_cte = cc.cta_cte AND cc.estado = 'A')                 
        INNER JOIN presupuesto.ejecutora as ej ON (f1.ano_eje = ej.ano_eje AND f1.sec_ejec = ej.sec_ejec AND ej.pliego = '459') 
        INNER JOIN (SELECT ano_eje, sec_ejec, id_clasificador, fuente_financ, SUM(presupuesto) as pia, SUM(modificacion) as modificacion, SUM(presupuesto) + SUM(modificacion) as pim
        FROM presupuesto.ingreso
        GROUP BY ano_eje, sec_ejec, id_clasificador, fuente_financ) as i ON (f1.ano_eje = i.ano_eje AND f1.sec_ejec = i.sec_ejec AND f1.id_clasificador = i.id_clasificador AND f1.fuente_financ = i.fuente_financ)        
        ${c}) as f1 ${d}
    </select>
    
    <select id="getRecaudacionMensualizada" parameterType="HashMap" resultMap="PresupuestoMap">
        SELECT me.mes, me.nombre, a.recaudado
        FROM utilitarios.meses as me 
        LEFT JOIN (SELECT a.ano_eje, a.sec_ejec, date_part('month', b.fecha_doc)::int as mes, SUM(a.monto_nacional) as recaudado
        FROM presupuesto.expediente_ingreso as a 
        INNER JOIN presupuesto.expediente_secuencia as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.expediente = b.expediente AND a.ciclo = b.ciclo AND 
        a.fase = b.fase AND a.secuencia = b.secuencia AND a.correlativo = b.correlativo AND a.estado_envio = b.estado_envio)
        INNER JOIN presupuesto.expediente_fase as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.expediente = c.expediente AND a.ciclo = c.ciclo AND 
        a.fase = c.fase AND a.secuencia = c.secuencia AND a.estado_envio = c.estado_envio)
        INNER JOIN presupuesto.fuente_financ as ru ON (a.ano_eje = ru.ano_eje AND c.fuente_financ = ru.fuente_financ AND ru.estado = 'A')
        INNER JOIN presupuesto.fuente_financ_agregada as fu ON (ru.ano_eje = fu.ano_eje AND ru.fuente_financ_agregada = fu.fuente_financ_agregada AND ru.estado = fu.estado)  
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')  
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND 
        ed.subgenerica = es.subgenerica AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)        
        INNER JOIN presupuesto.categoria_ingreso as ci ON (sgd.ano_eje = ci.ano_eje AND sgd.categoria_ingreso = ci.categoria_ingreso AND sgd.estado = ci.estado)   
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)        
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)             
        INNER JOIN presupuesto.tipo_recurso as tr ON (a.ano_eje = tr.ano_eje AND c.fuente_financ = tr.fuente_financ AND c.tipo_recurso = tr.tipo_recurso AND tr.estado = 'A')                         
        INNER JOIN presupuesto.banco as ba ON (b.banco = ba.banco AND ba.estado = 'A')                         
        INNER JOIN presupuesto.cta_cte as cc ON (a.sec_ejec = cc.sec_ejec AND b.ano_cta_cte = cc.ano_eje AND b.banco = cc.banco AND b.cta_cte = cc.cta_cte AND cc.estado = 'A')
        ${c} GROUP BY a.ano_eje, a.sec_ejec, date_part('month', b.fecha_doc)::int) as a ON (me.mes = a.mes) ORDER BY me.mes ASC
    </select>
    
    <select id="getListNotasTipo" parameterType="HashMap" resultMap="PresupuestoMap">
        SELECT a.tipo_modificacion as codigo, trim(b.timo_nombre) as nombre
        FROM presupuesto.nota_modificatoria_cab as a 
        INNER JOIN presupuesto.tipo_modificacion as b ON (a.tipo_modificacion = b.timo_id) ${c} 
    </select>
    
    <select id="getListNotasRubroGasto" parameterType="HashMap" resultMap="PresupuestoMap">
        SELECT a.fuente_financ as codigo, trim(b.nombre) as nombre
        FROM presupuesto.nota_modificatoria_det as a 
        INNER JOIN presupuesto.fuente_financ as b ON (a.ano_eje = b.ano_eje AND a.fuente_financ = b.fuente_financ) ${c} 
    </select>
    
    <select id="getListNotasRubroIngreso" parameterType="HashMap" resultMap="PresupuestoMap">
        SELECT a.fuente_financ as codigo, trim(b.nombre) as nombre
        FROM presupuesto.nota_modificatoria_ing as a 
        INNER JOIN presupuesto.fuente_financ as b ON (a.ano_eje = b.ano_eje AND a.fuente_financ = b.fuente_financ) ${c} 
    </select>   
    
    <select id="getListNotasGenericas" parameterType="HashMap" resultMap="PresupuestoMap">
        SELECT clasificador, trim(descripcion) as descripcion 
        FROM presupuesto.generica ${c} 
    </select> 
    
    <select id="getListNotasTipoRubroGasto" parameterType="HashMap" resultMap="PresupuestoMap">
        SELECT b.tipo_modificacion as codigo, trim(c.timo_nombre) as nombre
        FROM presupuesto.nota_modificatoria_det as a
        INNER JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        INNER JOIN presupuesto.tipo_modificacion as c ON (b.tipo_modificacion = c.timo_id) ${c} 
    </select>
    
    <select id="getListNotasTipoRubroIngreso" parameterType="HashMap" resultMap="PresupuestoMap">
        SELECT b.tipo_modificacion as codigo, trim(c.timo_nombre) as nombre
        FROM presupuesto.nota_modificatoria_ing as a
        INNER JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        INNER JOIN presupuesto.tipo_modificacion as c ON (b.tipo_modificacion = c.timo_id) ${c} 
    </select>
    
    <select id="getListResumModifPresuGastoxDoc" parameterType="HashMap" resultMap="PresupuestoMap">
        SELECT trim(t.documento) as nombre_documento, t.num_doc, t.mes, m.nombre as nombre_mes, t.fecha_doc, t0.monto as monto0, t1.monto as monto1, 
        t2.monto as monto2, t3.monto as monto3, t4.monto as monto4, t5.monto as monto5, t6.monto as monto6, t7.monto as monto7, t8.monto as monto8, t.monto as monto
        FROM
        (SELECT b.documento, b.num_doc, date_part('month', a.fecha)::int as mes, b.fecha_doc, SUM(a.monto_a) - SUM(a.monto_de) as monto
        FROM (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, c.fecha, 
        (CASE WHEN trim(c.sec_doc) = '' THEN ''
        WHEN c.sec_doc = '0000000000' THEN ''
        WHEN c.sec_doc != '0000000000' AND trim(c.sec_doc_r) = '' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r = '0000000000' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r != '0000000000' THEN c.sec_doc_r
        ELSE c.sec_doc_r END) as sec_doc,
        a.id_clasificador, a.monto_a, a.monto_de
        FROM presupuesto.nota_modificatoria_det as a
        INNER JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        INNER JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota) ${d}) as a
        INNER JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_doc, a.cod_doc, trim(b.nombre) as documento, a.num_doc, a.fecha_doc
        FROM presupuesto.nota_modificatoria_doc as a
        INNER JOIN presupuesto.maestro_documento as b ON (a.cod_doc = b.cod_doc)
        WHERE a.estado = 'A') as b ON (a.ano_eje = b.ano_eje AND a.sec_doc = b.sec_doc)
        GROUP BY b.documento, b.num_doc, date_part('month', a.fecha)::int, b.fecha_doc
        ORDER BY trim(b.num_doc), date_part('month', a.fecha)::int ASC) as t
        LEFT JOIN (SELECT b.documento, b.num_doc, date_part('month', a.fecha)::int as mes, b.fecha_doc, SUM(a.monto_a) - SUM(a.monto_de) as monto
        FROM (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, c.fecha, 
        (CASE WHEN trim(c.sec_doc) = '' THEN ''
        WHEN c.sec_doc = '0000000000' THEN ''
        WHEN c.sec_doc != '0000000000' AND trim(c.sec_doc_r) = '' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r = '0000000000' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r != '0000000000' THEN c.sec_doc_r
        ELSE c.sec_doc_r END) as sec_doc,
        a.id_clasificador, a.monto_a, a.monto_de
        FROM presupuesto.nota_modificatoria_det as a
        INNER JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        INNER JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')          
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_gasto as cg ON (sgd.ano_eje = cg.ano_eje AND sgd.categoria_gasto = cg.categ_gasto AND sgd.estado = cg.estado)        
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)       
        ${d} AND ge.clasificador = '2.0') as a
        INNER JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_doc, a.cod_doc, trim(b.nombre) as documento, a.num_doc, a.fecha_doc
        FROM presupuesto.nota_modificatoria_doc as a
        INNER JOIN presupuesto.maestro_documento as b ON (a.cod_doc = b.cod_doc)
        WHERE a.estado = 'A') as b ON (a.ano_eje = b.ano_eje AND a.sec_doc = b.sec_doc)
        GROUP BY b.documento, b.num_doc, date_part('month', a.fecha)::int, b.fecha_doc
        ORDER BY trim(b.num_doc), date_part('month', a.fecha)::int ASC) as t0 ON (t.documento = t0.documento AND t.num_doc = t0.num_doc AND t.mes = t0.mes AND t.fecha_doc = t0.fecha_doc)
        LEFT JOIN (SELECT b.documento, b.num_doc, date_part('month', a.fecha)::int as mes, b.fecha_doc, SUM(a.monto_a) - SUM(a.monto_de) as monto
        FROM (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, c.fecha, 
        (CASE WHEN trim(c.sec_doc) = '' THEN ''
        WHEN c.sec_doc = '0000000000' THEN ''
        WHEN c.sec_doc != '0000000000' AND trim(c.sec_doc_r) = '' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r = '0000000000' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r != '0000000000' THEN c.sec_doc_r
        ELSE c.sec_doc_r END) as sec_doc,
        a.id_clasificador, a.monto_a, a.monto_de
        FROM presupuesto.nota_modificatoria_det as a
        INNER JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        INNER JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')          
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_gasto as cg ON (sgd.ano_eje = cg.ano_eje AND sgd.categoria_gasto = cg.categ_gasto AND sgd.estado = cg.estado)        
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)       
        ${d} AND ge.clasificador = '2.1') as a
        INNER JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_doc, a.cod_doc, trim(b.nombre) as documento, a.num_doc, a.fecha_doc
        FROM presupuesto.nota_modificatoria_doc as a
        INNER JOIN presupuesto.maestro_documento as b ON (a.cod_doc = b.cod_doc)
        WHERE a.estado = 'A') as b ON (a.ano_eje = b.ano_eje AND a.sec_doc = b.sec_doc)
        GROUP BY b.documento, b.num_doc, date_part('month', a.fecha)::int, b.fecha_doc
        ORDER BY trim(b.num_doc), date_part('month', a.fecha)::int ASC) as t1 ON (t.documento = t1.documento AND t.num_doc = t1.num_doc AND t.mes = t1.mes AND t.fecha_doc = t1.fecha_doc)
        LEFT JOIN (SELECT b.documento, b.num_doc, date_part('month', a.fecha)::int as mes, b.fecha_doc, SUM(a.monto_a) - SUM(a.monto_de) as monto
        FROM (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, c.fecha, 
        (CASE WHEN trim(c.sec_doc) = '' THEN ''
        WHEN c.sec_doc = '0000000000' THEN ''
        WHEN c.sec_doc != '0000000000' AND trim(c.sec_doc_r) = '' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r = '0000000000' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r != '0000000000' THEN c.sec_doc_r
        ELSE c.sec_doc_r END) as sec_doc,
        a.id_clasificador, a.monto_a, a.monto_de
        FROM presupuesto.nota_modificatoria_det as a
        INNER JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        INNER JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')          
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_gasto as cg ON (sgd.ano_eje = cg.ano_eje AND sgd.categoria_gasto = cg.categ_gasto AND sgd.estado = cg.estado)        
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)       
        ${d} AND ge.clasificador = '2.2') as a
        INNER JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_doc, a.cod_doc, trim(b.nombre) as documento, a.num_doc, a.fecha_doc
        FROM presupuesto.nota_modificatoria_doc as a
        INNER JOIN presupuesto.maestro_documento as b ON (a.cod_doc = b.cod_doc)
        WHERE a.estado = 'A') as b ON (a.ano_eje = b.ano_eje AND a.sec_doc = b.sec_doc)
        GROUP BY b.documento, b.num_doc, date_part('month', a.fecha)::int, b.fecha_doc
        ORDER BY trim(b.num_doc), date_part('month', a.fecha)::int ASC) as t2 ON (t.documento = t2.documento AND t.num_doc = t2.num_doc AND t.mes = t2.mes AND t.fecha_doc = t2.fecha_doc)
        LEFT JOIN (SELECT b.documento, b.num_doc, date_part('month', a.fecha)::int as mes, b.fecha_doc, SUM(a.monto_a) - SUM(a.monto_de) as monto
        FROM (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, c.fecha, 
        (CASE WHEN trim(c.sec_doc) = '' THEN ''
        WHEN c.sec_doc = '0000000000' THEN ''
        WHEN c.sec_doc != '0000000000' AND trim(c.sec_doc_r) = '' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r = '0000000000' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r != '0000000000' THEN c.sec_doc_r
        ELSE c.sec_doc_r END) as sec_doc,
        a.id_clasificador, a.monto_a, a.monto_de
        FROM presupuesto.nota_modificatoria_det as a
        INNER JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        INNER JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')          
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_gasto as cg ON (sgd.ano_eje = cg.ano_eje AND sgd.categoria_gasto = cg.categ_gasto AND sgd.estado = cg.estado)        
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)       
        ${d} AND ge.clasificador = '2.3') as a
        INNER JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_doc, a.cod_doc, trim(b.nombre) as documento, a.num_doc, a.fecha_doc
        FROM presupuesto.nota_modificatoria_doc as a
        INNER JOIN presupuesto.maestro_documento as b ON (a.cod_doc = b.cod_doc)
        WHERE a.estado = 'A') as b ON (a.ano_eje = b.ano_eje AND a.sec_doc = b.sec_doc)
        GROUP BY b.documento, b.num_doc, date_part('month', a.fecha)::int, b.fecha_doc
        ORDER BY trim(b.num_doc), date_part('month', a.fecha)::int ASC) as t3 ON (t.documento = t3.documento AND t.num_doc = t3.num_doc AND t.mes = t3.mes AND t.fecha_doc = t3.fecha_doc)
        LEFT JOIN (SELECT b.documento, b.num_doc, date_part('month', a.fecha)::int as mes, b.fecha_doc, SUM(a.monto_a) - SUM(a.monto_de) as monto
        FROM (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, c.fecha, 
        (CASE WHEN trim(c.sec_doc) = '' THEN ''
        WHEN c.sec_doc = '0000000000' THEN ''
        WHEN c.sec_doc != '0000000000' AND trim(c.sec_doc_r) = '' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r = '0000000000' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r != '0000000000' THEN c.sec_doc_r
        ELSE c.sec_doc_r END) as sec_doc,
        a.id_clasificador, a.monto_a, a.monto_de
        FROM presupuesto.nota_modificatoria_det as a
        INNER JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        INNER JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')          
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_gasto as cg ON (sgd.ano_eje = cg.ano_eje AND sgd.categoria_gasto = cg.categ_gasto AND sgd.estado = cg.estado)        
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)       
        ${d} AND ge.clasificador = '2.4') as a
        INNER JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_doc, a.cod_doc, trim(b.nombre) as documento, a.num_doc, a.fecha_doc
        FROM presupuesto.nota_modificatoria_doc as a
        INNER JOIN presupuesto.maestro_documento as b ON (a.cod_doc = b.cod_doc)
        WHERE a.estado = 'A') as b ON (a.ano_eje = b.ano_eje AND a.sec_doc = b.sec_doc)
        GROUP BY b.documento, b.num_doc, date_part('month', a.fecha)::int, b.fecha_doc
        ORDER BY trim(b.num_doc), date_part('month', a.fecha)::int ASC) as t4 ON (t.documento = t4.documento AND t.num_doc = t4.num_doc AND t.mes = t4.mes AND t.fecha_doc = t4.fecha_doc)
        LEFT JOIN (SELECT b.documento, b.num_doc, date_part('month', a.fecha)::int as mes, b.fecha_doc, SUM(a.monto_a) - SUM(a.monto_de) as monto
        FROM (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, c.fecha, 
        (CASE WHEN trim(c.sec_doc) = '' THEN ''
        WHEN c.sec_doc = '0000000000' THEN ''
        WHEN c.sec_doc != '0000000000' AND trim(c.sec_doc_r) = '' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r = '0000000000' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r != '0000000000' THEN c.sec_doc_r
        ELSE c.sec_doc_r END) as sec_doc,
        a.id_clasificador, a.monto_a, a.monto_de
        FROM presupuesto.nota_modificatoria_det as a
        INNER JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        INNER JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')          
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_gasto as cg ON (sgd.ano_eje = cg.ano_eje AND sgd.categoria_gasto = cg.categ_gasto AND sgd.estado = cg.estado)        
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)       
        ${d} AND ge.clasificador = '2.5') as a
        INNER JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_doc, a.cod_doc, trim(b.nombre) as documento, a.num_doc, a.fecha_doc
        FROM presupuesto.nota_modificatoria_doc as a
        INNER JOIN presupuesto.maestro_documento as b ON (a.cod_doc = b.cod_doc)
        WHERE a.estado = 'A') as b ON (a.ano_eje = b.ano_eje AND a.sec_doc = b.sec_doc)
        GROUP BY b.documento, b.num_doc, date_part('month', a.fecha)::int, b.fecha_doc
        ORDER BY trim(b.num_doc), date_part('month', a.fecha)::int ASC) as t5 ON (t.documento = t5.documento AND t.num_doc = t5.num_doc AND t.mes = t5.mes AND t.fecha_doc = t5.fecha_doc)
        LEFT JOIN (SELECT b.documento, b.num_doc, date_part('month', a.fecha)::int as mes, b.fecha_doc, SUM(a.monto_a) - SUM(a.monto_de) as monto
        FROM (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, c.fecha, 
        (CASE WHEN trim(c.sec_doc) = '' THEN ''
        WHEN c.sec_doc = '0000000000' THEN ''
        WHEN c.sec_doc != '0000000000' AND trim(c.sec_doc_r) = '' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r = '0000000000' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r != '0000000000' THEN c.sec_doc_r
        ELSE c.sec_doc_r END) as sec_doc,
        a.id_clasificador, a.monto_a, a.monto_de
        FROM presupuesto.nota_modificatoria_det as a
        INNER JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        INNER JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')          
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_gasto as cg ON (sgd.ano_eje = cg.ano_eje AND sgd.categoria_gasto = cg.categ_gasto AND sgd.estado = cg.estado)        
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)       
        ${d} AND ge.clasificador = '2.6') as a
        INNER JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_doc, a.cod_doc, trim(b.nombre) as documento, a.num_doc, a.fecha_doc
        FROM presupuesto.nota_modificatoria_doc as a
        INNER JOIN presupuesto.maestro_documento as b ON (a.cod_doc = b.cod_doc)
        WHERE a.estado = 'A') as b ON (a.ano_eje = b.ano_eje AND a.sec_doc = b.sec_doc)
        GROUP BY b.documento, b.num_doc, date_part('month', a.fecha)::int, b.fecha_doc
        ORDER BY trim(b.num_doc), date_part('month', a.fecha)::int ASC) as t6 ON (t.documento = t6.documento AND t.num_doc = t6.num_doc AND t.mes = t6.mes AND t.fecha_doc = t6.fecha_doc)
        LEFT JOIN (SELECT b.documento, b.num_doc, date_part('month', a.fecha)::int as mes, b.fecha_doc, SUM(a.monto_a) - SUM(a.monto_de) as monto
        FROM (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, c.fecha, 
        (CASE WHEN trim(c.sec_doc) = '' THEN ''
        WHEN c.sec_doc = '0000000000' THEN ''
        WHEN c.sec_doc != '0000000000' AND trim(c.sec_doc_r) = '' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r = '0000000000' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r != '0000000000' THEN c.sec_doc_r
        ELSE c.sec_doc_r END) as sec_doc,
        a.id_clasificador, a.monto_a, a.monto_de
        FROM presupuesto.nota_modificatoria_det as a
        INNER JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        INNER JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')          
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_gasto as cg ON (sgd.ano_eje = cg.ano_eje AND sgd.categoria_gasto = cg.categ_gasto AND sgd.estado = cg.estado)        
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)       
        ${d} AND ge.clasificador = '2.7') as a
        INNER JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_doc, a.cod_doc, trim(b.nombre) as documento, a.num_doc, a.fecha_doc
        FROM presupuesto.nota_modificatoria_doc as a
        INNER JOIN presupuesto.maestro_documento as b ON (a.cod_doc = b.cod_doc)
        WHERE a.estado = 'A') as b ON (a.ano_eje = b.ano_eje AND a.sec_doc = b.sec_doc)
        GROUP BY b.documento, b.num_doc, date_part('month', a.fecha)::int, b.fecha_doc
        ORDER BY trim(b.num_doc), date_part('month', a.fecha)::int ASC) as t7 ON (t.documento = t7.documento AND t.num_doc = t7.num_doc AND t.mes = t7.mes AND t.fecha_doc = t7.fecha_doc)
        LEFT JOIN (SELECT b.documento, b.num_doc, date_part('month', a.fecha)::int as mes, b.fecha_doc, SUM(a.monto_a) - SUM(a.monto_de) as monto
        FROM (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, c.fecha, 
        (CASE WHEN trim(c.sec_doc) = '' THEN ''
        WHEN c.sec_doc = '0000000000' THEN ''
        WHEN c.sec_doc != '0000000000' AND trim(c.sec_doc_r) = '' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r = '0000000000' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r != '0000000000' THEN c.sec_doc_r
        ELSE c.sec_doc_r END) as sec_doc,
        a.id_clasificador, a.monto_a, a.monto_de
        FROM presupuesto.nota_modificatoria_det as a
        INNER JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        INNER JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')          
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_gasto as cg ON (sgd.ano_eje = cg.ano_eje AND sgd.categoria_gasto = cg.categ_gasto AND sgd.estado = cg.estado)        
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)       
        ${d} AND ge.clasificador = '2.8') as a
        INNER JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_doc, a.cod_doc, trim(b.nombre) as documento, a.num_doc, a.fecha_doc
        FROM presupuesto.nota_modificatoria_doc as a
        INNER JOIN presupuesto.maestro_documento as b ON (a.cod_doc = b.cod_doc)
        WHERE a.estado = 'A') as b ON (a.ano_eje = b.ano_eje AND a.sec_doc = b.sec_doc)
        GROUP BY b.documento, b.num_doc, date_part('month', a.fecha)::int, b.fecha_doc
        ORDER BY trim(b.num_doc), date_part('month', a.fecha)::int ASC) as t8 ON (t.documento = t8.documento AND t.num_doc = t8.num_doc AND t.mes = t8.mes AND t.fecha_doc = t8.fecha_doc) 
        INNER JOIN utilitarios.meses as m ON (t.mes = m.mes) ${c}
    </select>  
    
    <select id="getListResumModifPresuIngresoxDoc" parameterType="HashMap" resultMap="PresupuestoMap">
        SELECT trim(t.documento) as nombre_documento, t.num_doc, t.mes, m.nombre as nombre_mes, t.fecha_doc, t0.monto as monto0, t1.monto as monto1, 
        t2.monto as monto2, t3.monto as monto3, t4.monto as monto4, t5.monto as monto5, t6.monto as monto6, t7.monto as monto7, t8.monto as monto8, t.monto as monto
        FROM
        (SELECT b.documento, b.num_doc, date_part('month', a.fecha)::int as mes, b.fecha_doc, SUM(a.monto_a) - SUM(a.monto_de) as monto
        FROM (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, c.fecha, 
        (CASE WHEN trim(c.sec_doc) = '' THEN ''
        WHEN c.sec_doc = '0000000000' THEN ''
        WHEN c.sec_doc != '0000000000' AND trim(c.sec_doc_r) = '' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r = '0000000000' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r != '0000000000' THEN c.sec_doc_r
        ELSE c.sec_doc_r END) as sec_doc,
        a.id_clasificador, a.monto_a, a.monto_de
        FROM presupuesto.nota_modificatoria_ing as a
        INNER JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        INNER JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota) ${d}) as a
        INNER JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_doc, a.cod_doc, trim(b.nombre) as documento, a.num_doc, a.fecha_doc
        FROM presupuesto.nota_modificatoria_doc as a
        INNER JOIN presupuesto.maestro_documento as b ON (a.cod_doc = b.cod_doc)
        WHERE a.estado = 'A') as b ON (a.ano_eje = b.ano_eje AND a.sec_doc = b.sec_doc)
        GROUP BY b.documento, b.num_doc, date_part('month', a.fecha)::int, b.fecha_doc
        ORDER BY trim(b.num_doc), date_part('month', a.fecha)::int ASC) as t        
        LEFT JOIN (SELECT b.documento, b.num_doc, date_part('month', a.fecha)::int as mes, b.fecha_doc, SUM(a.monto_a) - SUM(a.monto_de) as monto
        FROM (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, c.fecha, 
        (CASE WHEN trim(c.sec_doc) = '' THEN ''
        WHEN c.sec_doc = '0000000000' THEN ''
        WHEN c.sec_doc != '0000000000' AND trim(c.sec_doc_r) = '' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r = '0000000000' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r != '0000000000' THEN c.sec_doc_r
        ELSE c.sec_doc_r END) as sec_doc,
        a.id_clasificador, a.monto_a, a.monto_de
        FROM presupuesto.nota_modificatoria_ing as a
        INNER JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        INNER JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')          
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)        
        INNER JOIN presupuesto.categoria_ingreso as ci ON (sgd.ano_eje = ci.ano_eje AND sgd.categoria_ingreso = ci.categoria_ingreso AND sgd.estado = ci.estado)       
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)       
        ${d} AND ge.clasificador = '1.1') as a
        INNER JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_doc, a.cod_doc, trim(b.nombre) as documento, a.num_doc, a.fecha_doc
        FROM presupuesto.nota_modificatoria_doc as a
        INNER JOIN presupuesto.maestro_documento as b ON (a.cod_doc = b.cod_doc)
        WHERE a.estado = 'A') as b ON (a.ano_eje = b.ano_eje AND a.sec_doc = b.sec_doc)
        GROUP BY b.documento, b.num_doc, date_part('month', a.fecha)::int, b.fecha_doc
        ORDER BY trim(b.num_doc), date_part('month', a.fecha)::int ASC) as t0 ON (t.documento = t0.documento AND t.num_doc = t0.num_doc AND t.mes = t0.mes AND t.fecha_doc = t0.fecha_doc)
        LEFT JOIN (SELECT b.documento, b.num_doc, date_part('month', a.fecha)::int as mes, b.fecha_doc, SUM(a.monto_a) - SUM(a.monto_de) as monto
        FROM (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, c.fecha, 
        (CASE WHEN trim(c.sec_doc) = '' THEN ''
        WHEN c.sec_doc = '0000000000' THEN ''
        WHEN c.sec_doc != '0000000000' AND trim(c.sec_doc_r) = '' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r = '0000000000' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r != '0000000000' THEN c.sec_doc_r
        ELSE c.sec_doc_r END) as sec_doc,
        a.id_clasificador, a.monto_a, a.monto_de
        FROM presupuesto.nota_modificatoria_ing as a
        INNER JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        INNER JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')          
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_ingreso as ci ON (sgd.ano_eje = ci.ano_eje AND sgd.categoria_ingreso = ci.categoria_ingreso AND sgd.estado = ci.estado)
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)       
        ${d} AND ge.clasificador = '1.2') as a
        INNER JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_doc, a.cod_doc, trim(b.nombre) as documento, a.num_doc, a.fecha_doc
        FROM presupuesto.nota_modificatoria_doc as a
        INNER JOIN presupuesto.maestro_documento as b ON (a.cod_doc = b.cod_doc)
        WHERE a.estado = 'A') as b ON (a.ano_eje = b.ano_eje AND a.sec_doc = b.sec_doc)
        GROUP BY b.documento, b.num_doc, date_part('month', a.fecha)::int, b.fecha_doc
        ORDER BY trim(b.num_doc), date_part('month', a.fecha)::int ASC) as t1 ON (t.documento = t1.documento AND t.num_doc = t1.num_doc AND t.mes = t1.mes AND t.fecha_doc = t1.fecha_doc)
        LEFT JOIN (SELECT b.documento, b.num_doc, date_part('month', a.fecha)::int as mes, b.fecha_doc, SUM(a.monto_a) - SUM(a.monto_de) as monto
        FROM (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, c.fecha, 
        (CASE WHEN trim(c.sec_doc) = '' THEN ''
        WHEN c.sec_doc = '0000000000' THEN ''
        WHEN c.sec_doc != '0000000000' AND trim(c.sec_doc_r) = '' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r = '0000000000' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r != '0000000000' THEN c.sec_doc_r
        ELSE c.sec_doc_r END) as sec_doc,
        a.id_clasificador, a.monto_a, a.monto_de
        FROM presupuesto.nota_modificatoria_ing as a
        INNER JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        INNER JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')          
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_ingreso as ci ON (sgd.ano_eje = ci.ano_eje AND sgd.categoria_ingreso = ci.categoria_ingreso AND sgd.estado = ci.estado)
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)       
        ${d} AND ge.clasificador = '1.3') as a
        INNER JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_doc, a.cod_doc, trim(b.nombre) as documento, a.num_doc, a.fecha_doc
        FROM presupuesto.nota_modificatoria_doc as a
        INNER JOIN presupuesto.maestro_documento as b ON (a.cod_doc = b.cod_doc)
        WHERE a.estado = 'A') as b ON (a.ano_eje = b.ano_eje AND a.sec_doc = b.sec_doc)
        GROUP BY b.documento, b.num_doc, date_part('month', a.fecha)::int, b.fecha_doc
        ORDER BY trim(b.num_doc), date_part('month', a.fecha)::int ASC) as t2 ON (t.documento = t2.documento AND t.num_doc = t2.num_doc AND t.mes = t2.mes AND t.fecha_doc = t2.fecha_doc)
        LEFT JOIN (SELECT b.documento, b.num_doc, date_part('month', a.fecha)::int as mes, b.fecha_doc, SUM(a.monto_a) - SUM(a.monto_de) as monto
        FROM (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, c.fecha, 
        (CASE WHEN trim(c.sec_doc) = '' THEN ''
        WHEN c.sec_doc = '0000000000' THEN ''
        WHEN c.sec_doc != '0000000000' AND trim(c.sec_doc_r) = '' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r = '0000000000' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r != '0000000000' THEN c.sec_doc_r
        ELSE c.sec_doc_r END) as sec_doc,
        a.id_clasificador, a.monto_a, a.monto_de
        FROM presupuesto.nota_modificatoria_ing as a
        INNER JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        INNER JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')          
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_ingreso as ci ON (sgd.ano_eje = ci.ano_eje AND sgd.categoria_ingreso = ci.categoria_ingreso AND sgd.estado = ci.estado)
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)       
        ${d} AND ge.clasificador = '1.4') as a
        INNER JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_doc, a.cod_doc, trim(b.nombre) as documento, a.num_doc, a.fecha_doc
        FROM presupuesto.nota_modificatoria_doc as a
        INNER JOIN presupuesto.maestro_documento as b ON (a.cod_doc = b.cod_doc)
        WHERE a.estado = 'A') as b ON (a.ano_eje = b.ano_eje AND a.sec_doc = b.sec_doc)
        GROUP BY b.documento, b.num_doc, date_part('month', a.fecha)::int, b.fecha_doc
        ORDER BY trim(b.num_doc), date_part('month', a.fecha)::int ASC) as t3 ON (t.documento = t3.documento AND t.num_doc = t3.num_doc AND t.mes = t3.mes AND t.fecha_doc = t3.fecha_doc)
        LEFT JOIN (SELECT b.documento, b.num_doc, date_part('month', a.fecha)::int as mes, b.fecha_doc, SUM(a.monto_a) - SUM(a.monto_de) as monto
        FROM (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, c.fecha, 
        (CASE WHEN trim(c.sec_doc) = '' THEN ''
        WHEN c.sec_doc = '0000000000' THEN ''
        WHEN c.sec_doc != '0000000000' AND trim(c.sec_doc_r) = '' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r = '0000000000' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r != '0000000000' THEN c.sec_doc_r
        ELSE c.sec_doc_r END) as sec_doc,
        a.id_clasificador, a.monto_a, a.monto_de
        FROM presupuesto.nota_modificatoria_ing as a
        INNER JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        INNER JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')          
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_ingreso as ci ON (sgd.ano_eje = ci.ano_eje AND sgd.categoria_ingreso = ci.categoria_ingreso AND sgd.estado = ci.estado)
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)       
        ${d} AND ge.clasificador = '1.5') as a
        INNER JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_doc, a.cod_doc, trim(b.nombre) as documento, a.num_doc, a.fecha_doc
        FROM presupuesto.nota_modificatoria_doc as a
        INNER JOIN presupuesto.maestro_documento as b ON (a.cod_doc = b.cod_doc)
        WHERE a.estado = 'A') as b ON (a.ano_eje = b.ano_eje AND a.sec_doc = b.sec_doc)
        GROUP BY b.documento, b.num_doc, date_part('month', a.fecha)::int, b.fecha_doc
        ORDER BY trim(b.num_doc), date_part('month', a.fecha)::int ASC) as t4 ON (t.documento = t4.documento AND t.num_doc = t4.num_doc AND t.mes = t4.mes AND t.fecha_doc = t4.fecha_doc)
        LEFT JOIN (SELECT b.documento, b.num_doc, date_part('month', a.fecha)::int as mes, b.fecha_doc, SUM(a.monto_a) - SUM(a.monto_de) as monto
        FROM (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, c.fecha, 
        (CASE WHEN trim(c.sec_doc) = '' THEN ''
        WHEN c.sec_doc = '0000000000' THEN ''
        WHEN c.sec_doc != '0000000000' AND trim(c.sec_doc_r) = '' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r = '0000000000' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r != '0000000000' THEN c.sec_doc_r
        ELSE c.sec_doc_r END) as sec_doc,
        a.id_clasificador, a.monto_a, a.monto_de
        FROM presupuesto.nota_modificatoria_ing as a
        INNER JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        INNER JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')          
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_ingreso as ci ON (sgd.ano_eje = ci.ano_eje AND sgd.categoria_ingreso = ci.categoria_ingreso AND sgd.estado = ci.estado)
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)       
        ${d} AND ge.clasificador = '1.6') as a
        INNER JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_doc, a.cod_doc, trim(b.nombre) as documento, a.num_doc, a.fecha_doc
        FROM presupuesto.nota_modificatoria_doc as a
        INNER JOIN presupuesto.maestro_documento as b ON (a.cod_doc = b.cod_doc)
        WHERE a.estado = 'A') as b ON (a.ano_eje = b.ano_eje AND a.sec_doc = b.sec_doc)
        GROUP BY b.documento, b.num_doc, date_part('month', a.fecha)::int, b.fecha_doc
        ORDER BY trim(b.num_doc), date_part('month', a.fecha)::int ASC) as t5 ON (t.documento = t5.documento AND t.num_doc = t5.num_doc AND t.mes = t5.mes AND t.fecha_doc = t5.fecha_doc)
        LEFT JOIN (SELECT b.documento, b.num_doc, date_part('month', a.fecha)::int as mes, b.fecha_doc, SUM(a.monto_a) - SUM(a.monto_de) as monto
        FROM (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, c.fecha, 
        (CASE WHEN trim(c.sec_doc) = '' THEN ''
        WHEN c.sec_doc = '0000000000' THEN ''
        WHEN c.sec_doc != '0000000000' AND trim(c.sec_doc_r) = '' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r = '0000000000' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r != '0000000000' THEN c.sec_doc_r
        ELSE c.sec_doc_r END) as sec_doc,
        a.id_clasificador, a.monto_a, a.monto_de
        FROM presupuesto.nota_modificatoria_ing as a
        INNER JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        INNER JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')          
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_ingreso as ci ON (sgd.ano_eje = ci.ano_eje AND sgd.categoria_ingreso = ci.categoria_ingreso AND sgd.estado = ci.estado)
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)       
        ${d} AND ge.clasificador = '1.7') as a
        INNER JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_doc, a.cod_doc, trim(b.nombre) as documento, a.num_doc, a.fecha_doc
        FROM presupuesto.nota_modificatoria_doc as a
        INNER JOIN presupuesto.maestro_documento as b ON (a.cod_doc = b.cod_doc)
        WHERE a.estado = 'A') as b ON (a.ano_eje = b.ano_eje AND a.sec_doc = b.sec_doc)
        GROUP BY b.documento, b.num_doc, date_part('month', a.fecha)::int, b.fecha_doc
        ORDER BY trim(b.num_doc), date_part('month', a.fecha)::int ASC) as t6 ON (t.documento = t6.documento AND t.num_doc = t6.num_doc AND t.mes = t6.mes AND t.fecha_doc = t6.fecha_doc)
        LEFT JOIN (SELECT b.documento, b.num_doc, date_part('month', a.fecha)::int as mes, b.fecha_doc, SUM(a.monto_a) - SUM(a.monto_de) as monto
        FROM (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, c.fecha, 
        (CASE WHEN trim(c.sec_doc) = '' THEN ''
        WHEN c.sec_doc = '0000000000' THEN ''
        WHEN c.sec_doc != '0000000000' AND trim(c.sec_doc_r) = '' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r = '0000000000' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r != '0000000000' THEN c.sec_doc_r
        ELSE c.sec_doc_r END) as sec_doc,
        a.id_clasificador, a.monto_a, a.monto_de
        FROM presupuesto.nota_modificatoria_ing as a
        INNER JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        INNER JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')          
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_ingreso as ci ON (sgd.ano_eje = ci.ano_eje AND sgd.categoria_ingreso = ci.categoria_ingreso AND sgd.estado = ci.estado)
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)       
        ${d} AND ge.clasificador = '1.8') as a
        INNER JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_doc, a.cod_doc, trim(b.nombre) as documento, a.num_doc, a.fecha_doc
        FROM presupuesto.nota_modificatoria_doc as a
        INNER JOIN presupuesto.maestro_documento as b ON (a.cod_doc = b.cod_doc)
        WHERE a.estado = 'A') as b ON (a.ano_eje = b.ano_eje AND a.sec_doc = b.sec_doc)
        GROUP BY b.documento, b.num_doc, date_part('month', a.fecha)::int, b.fecha_doc
        ORDER BY trim(b.num_doc), date_part('month', a.fecha)::int ASC) as t7 ON (t.documento = t7.documento AND t.num_doc = t7.num_doc AND t.mes = t7.mes AND t.fecha_doc = t7.fecha_doc)
        LEFT JOIN (SELECT b.documento, b.num_doc, date_part('month', a.fecha)::int as mes, b.fecha_doc, SUM(a.monto_a) - SUM(a.monto_de) as monto
        FROM (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, c.fecha, 
        (CASE WHEN trim(c.sec_doc) = '' THEN ''
        WHEN c.sec_doc = '0000000000' THEN ''
        WHEN c.sec_doc != '0000000000' AND trim(c.sec_doc_r) = '' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r = '0000000000' THEN c.sec_doc
        WHEN c.sec_doc != '0000000000' AND c.sec_doc_r != '0000000000' THEN c.sec_doc_r
        ELSE c.sec_doc_r END) as sec_doc,
        a.id_clasificador, a.monto_a, a.monto_de
        FROM presupuesto.nota_modificatoria_ing as a
        INNER JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        INNER JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')          
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_ingreso as ci ON (sgd.ano_eje = ci.ano_eje AND sgd.categoria_ingreso = ci.categoria_ingreso AND sgd.estado = ci.estado)
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)       
        ${d} AND ge.clasificador = '1.9') as a
        INNER JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_doc, a.cod_doc, trim(b.nombre) as documento, a.num_doc, a.fecha_doc
        FROM presupuesto.nota_modificatoria_doc as a
        INNER JOIN presupuesto.maestro_documento as b ON (a.cod_doc = b.cod_doc)
        WHERE a.estado = 'A') as b ON (a.ano_eje = b.ano_eje AND a.sec_doc = b.sec_doc)
        GROUP BY b.documento, b.num_doc, date_part('month', a.fecha)::int, b.fecha_doc
        ORDER BY trim(b.num_doc), date_part('month', a.fecha)::int ASC) as t8 ON (t.documento = t8.documento AND t.num_doc = t8.num_doc AND t.mes = t8.mes AND t.fecha_doc = t8.fecha_doc) 
        INNER JOIN utilitarios.meses as m ON (t.mes = m.mes) ${c} 
    </select>   
    
    <select id="getListResumModifPresuGastoxNota" parameterType="HashMap" resultMap="PresupuestoMap">
        SELECT t.ano_eje, t.sec_ejec, ej.ejecutora, trim(ej.nombre) as nombre, t.sec_ejec2, t.sec_nota, t.mes, m.nombre as nombre_mes, 
        t0.monto0, t1.monto1, t2.monto2, t3.monto3, t4.monto4, t5.monto5, t6.monto6, t7.monto7, t8.monto8, t.monto
        FROM
        (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje as mes, SUM(a.monto_a) - SUM(a.monto_de) as monto
        FROM presupuesto.nota_modificatoria_det as a
        LEFT JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        LEFT JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        ${c} GROUP BY a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje) as t
        LEFT JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje as mes, SUM(a.monto_a) - SUM(a.monto_de) as monto0
        FROM presupuesto.nota_modificatoria_det as a
        LEFT JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        LEFT JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')          
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_gasto as cg ON (sgd.ano_eje = cg.ano_eje AND sgd.categoria_gasto = cg.categ_gasto AND sgd.estado = cg.estado)        
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)
        ${c} AND ge.clasificador = '2.0' GROUP BY a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje) as t0 ON 
        (t.ano_eje = t0.ano_eje AND t.sec_ejec = t0.sec_ejec AND t.sec_ejec2 = t0.sec_ejec2 AND t.sec_nota = t0.sec_nota AND t.mes = t0.mes)
        LEFT JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje as mes, SUM(a.monto_a) - SUM(a.monto_de) as monto1
        FROM presupuesto.nota_modificatoria_det as a
        LEFT JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        LEFT JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')          
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_gasto as cg ON (sgd.ano_eje = cg.ano_eje AND sgd.categoria_gasto = cg.categ_gasto AND sgd.estado = cg.estado)        
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)
        ${c} AND ge.clasificador = '2.1' GROUP BY a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje) as t1 ON 
        (t.ano_eje = t1.ano_eje AND t.sec_ejec = t1.sec_ejec AND t.sec_ejec2 = t1.sec_ejec2 AND t.sec_nota = t1.sec_nota AND t.mes = t1.mes)
        LEFT JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje as mes, SUM(a.monto_a) - SUM(a.monto_de) as monto2
        FROM presupuesto.nota_modificatoria_det as a
        LEFT JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        LEFT JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')          
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_gasto as cg ON (sgd.ano_eje = cg.ano_eje AND sgd.categoria_gasto = cg.categ_gasto AND sgd.estado = cg.estado)        
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)
        ${c} AND ge.clasificador = '2.2' GROUP BY a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje) as t2 ON 
        (t.ano_eje = t2.ano_eje AND t.sec_ejec = t2.sec_ejec AND t.sec_ejec2 = t2.sec_ejec2 AND t.sec_nota = t2.sec_nota AND t.mes = t2.mes)
        LEFT JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje as mes, SUM(a.monto_a) - SUM(a.monto_de) as monto3
        FROM presupuesto.nota_modificatoria_det as a
        LEFT JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        LEFT JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')          
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_gasto as cg ON (sgd.ano_eje = cg.ano_eje AND sgd.categoria_gasto = cg.categ_gasto AND sgd.estado = cg.estado)        
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)
        ${c} AND ge.clasificador = '2.3' GROUP BY a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje) as t3 ON 
        (t.ano_eje = t3.ano_eje AND t.sec_ejec = t3.sec_ejec AND t.sec_ejec2 = t3.sec_ejec2 AND t.sec_nota = t3.sec_nota AND t.mes = t3.mes)
        LEFT JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje as mes, SUM(a.monto_a) - SUM(a.monto_de) as monto4
        FROM presupuesto.nota_modificatoria_det as a
        LEFT JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        LEFT JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')          
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_gasto as cg ON (sgd.ano_eje = cg.ano_eje AND sgd.categoria_gasto = cg.categ_gasto AND sgd.estado = cg.estado)        
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)
        ${c} AND ge.clasificador = '2.4' GROUP BY a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje) as t4 ON 
        (t.ano_eje = t4.ano_eje AND t.sec_ejec = t4.sec_ejec AND t.sec_ejec2 = t4.sec_ejec2 AND t.sec_nota = t4.sec_nota AND t.mes = t4.mes)
        LEFT JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje as mes, SUM(a.monto_a) - SUM(a.monto_de) as monto5
        FROM presupuesto.nota_modificatoria_det as a
        LEFT JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        LEFT JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')          
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_gasto as cg ON (sgd.ano_eje = cg.ano_eje AND sgd.categoria_gasto = cg.categ_gasto AND sgd.estado = cg.estado)        
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)
        ${c} AND ge.clasificador = '2.5' GROUP BY a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje) as t5 ON 
        (t.ano_eje = t5.ano_eje AND t.sec_ejec = t5.sec_ejec AND t.sec_ejec2 = t5.sec_ejec2 AND t.sec_nota = t5.sec_nota AND t.mes = t5.mes)
        LEFT JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje as mes, SUM(a.monto_a) - SUM(a.monto_de) as monto6
        FROM presupuesto.nota_modificatoria_det as a
        LEFT JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        LEFT JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')          
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_gasto as cg ON (sgd.ano_eje = cg.ano_eje AND sgd.categoria_gasto = cg.categ_gasto AND sgd.estado = cg.estado)        
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)
        ${c} AND ge.clasificador = '2.6' GROUP BY a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje) as t6 ON 
        (t.ano_eje = t6.ano_eje AND t.sec_ejec = t6.sec_ejec AND t.sec_ejec2 = t6.sec_ejec2 AND t.sec_nota = t6.sec_nota AND t.mes = t6.mes)
        LEFT JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje as mes, SUM(a.monto_a) - SUM(a.monto_de) as monto7
        FROM presupuesto.nota_modificatoria_det as a
        LEFT JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        LEFT JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')          
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_gasto as cg ON (sgd.ano_eje = cg.ano_eje AND sgd.categoria_gasto = cg.categ_gasto AND sgd.estado = cg.estado)        
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)
        ${c} AND ge.clasificador = '2.7' GROUP BY a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje) as t7 ON 
        (t.ano_eje = t7.ano_eje AND t.sec_ejec = t7.sec_ejec AND t.sec_ejec2 = t7.sec_ejec2 AND t.sec_nota = t7.sec_nota AND t.mes = t7.mes)
        LEFT JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje as mes, SUM(a.monto_a) - SUM(a.monto_de) as monto8
        FROM presupuesto.nota_modificatoria_det as a
        LEFT JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        LEFT JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')          
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_gasto as cg ON (sgd.ano_eje = cg.ano_eje AND sgd.categoria_gasto = cg.categ_gasto AND sgd.estado = cg.estado)        
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)
        ${c} AND ge.clasificador = '2.8' GROUP BY a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje) as t8 ON 
        (t.ano_eje = t8.ano_eje AND t.sec_ejec = t8.sec_ejec AND t.sec_ejec2 = t8.sec_ejec2 AND t.sec_nota = t8.sec_nota AND t.mes = t8.mes)
        INNER JOIN utilitarios.meses as m ON (t.mes::int = m.mes)
        INNER JOIN presupuesto.ejecutora as ej ON (t.ano_eje = ej.ano_eje AND t.sec_ejec = ej.sec_ejec AND ej.pliego = '459')
        ORDER BY t.ano_eje, t.sec_nota, t.sec_ejec ASC        
    </select>      
         
    <select id="getListResumModifPresuIngresoxNota" parameterType="HashMap" resultMap="PresupuestoMap">
        SELECT t.ano_eje, t.sec_ejec, ej.ejecutora, trim(ej.nombre) as nombre, t.sec_ejec2, t.sec_nota, t.mes, m.nombre as nombre_mes, 
        t0.monto0, t1.monto1, t2.monto2, t3.monto3, t4.monto4, t5.monto5, t6.monto6, t7.monto7, t8.monto8, t.monto
        FROM
        (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje as mes, SUM(a.monto_a) - SUM(a.monto_de) as monto
        FROM presupuesto.nota_modificatoria_ing as a
        LEFT JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        LEFT JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        ${c} GROUP BY a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje) as t
        LEFT JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje as mes, SUM(a.monto_a) - SUM(a.monto_de) as monto0
        FROM presupuesto.nota_modificatoria_ing as a
        LEFT JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        LEFT JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')          
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_ingreso as ci ON (sgd.ano_eje = ci.ano_eje AND sgd.categoria_ingreso = ci.categoria_ingreso AND sgd.estado = ci.estado)
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)
        ${c} AND ge.clasificador = '1.1' GROUP BY a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje) as t0 ON 
        (t.ano_eje = t0.ano_eje AND t.sec_ejec = t0.sec_ejec AND t.sec_ejec2 = t0.sec_ejec2 AND t.sec_nota = t0.sec_nota AND t.mes = t0.mes)
        LEFT JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje as mes, SUM(a.monto_a) - SUM(a.monto_de) as monto1
        FROM presupuesto.nota_modificatoria_ing as a
        LEFT JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        LEFT JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')          
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_ingreso as ci ON (sgd.ano_eje = ci.ano_eje AND sgd.categoria_ingreso = ci.categoria_ingreso AND sgd.estado = ci.estado)
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)
        ${c} AND ge.clasificador = '1.2' GROUP BY a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje) as t1 ON 
        (t.ano_eje = t1.ano_eje AND t.sec_ejec = t1.sec_ejec AND t.sec_ejec2 = t1.sec_ejec2 AND t.sec_nota = t1.sec_nota AND t.mes = t1.mes)
        LEFT JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje as mes, SUM(a.monto_a) - SUM(a.monto_de) as monto2
        FROM presupuesto.nota_modificatoria_ing as a
        LEFT JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        LEFT JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')          
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_ingreso as ci ON (sgd.ano_eje = ci.ano_eje AND sgd.categoria_ingreso = ci.categoria_ingreso AND sgd.estado = ci.estado)
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)
        ${c} AND ge.clasificador = '1.3' GROUP BY a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje) as t2 ON 
        (t.ano_eje = t2.ano_eje AND t.sec_ejec = t2.sec_ejec AND t.sec_ejec2 = t2.sec_ejec2 AND t.sec_nota = t2.sec_nota AND t.mes = t2.mes)
        LEFT JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje as mes, SUM(a.monto_a) - SUM(a.monto_de) as monto3
        FROM presupuesto.nota_modificatoria_ing as a
        LEFT JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        LEFT JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')          
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_ingreso as ci ON (sgd.ano_eje = ci.ano_eje AND sgd.categoria_ingreso = ci.categoria_ingreso AND sgd.estado = ci.estado)
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)
        ${c} AND ge.clasificador = '1.4' GROUP BY a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje) as t3 ON 
        (t.ano_eje = t3.ano_eje AND t.sec_ejec = t3.sec_ejec AND t.sec_ejec2 = t3.sec_ejec2 AND t.sec_nota = t3.sec_nota AND t.mes = t3.mes)
        LEFT JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje as mes, SUM(a.monto_a) - SUM(a.monto_de) as monto4
        FROM presupuesto.nota_modificatoria_ing as a
        LEFT JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        LEFT JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')          
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_ingreso as ci ON (sgd.ano_eje = ci.ano_eje AND sgd.categoria_ingreso = ci.categoria_ingreso AND sgd.estado = ci.estado)
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)
        ${c} AND ge.clasificador = '1.5' GROUP BY a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje) as t4 ON 
        (t.ano_eje = t4.ano_eje AND t.sec_ejec = t4.sec_ejec AND t.sec_ejec2 = t4.sec_ejec2 AND t.sec_nota = t4.sec_nota AND t.mes = t4.mes)
        LEFT JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje as mes, SUM(a.monto_a) - SUM(a.monto_de) as monto5
        FROM presupuesto.nota_modificatoria_ing as a
        LEFT JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        LEFT JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')          
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_ingreso as ci ON (sgd.ano_eje = ci.ano_eje AND sgd.categoria_ingreso = ci.categoria_ingreso AND sgd.estado = ci.estado)
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)
        ${c} AND ge.clasificador = '1.6' GROUP BY a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje) as t5 ON 
        (t.ano_eje = t5.ano_eje AND t.sec_ejec = t5.sec_ejec AND t.sec_ejec2 = t5.sec_ejec2 AND t.sec_nota = t5.sec_nota AND t.mes = t5.mes)
        LEFT JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje as mes, SUM(a.monto_a) - SUM(a.monto_de) as monto6
        FROM presupuesto.nota_modificatoria_ing as a
        LEFT JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        LEFT JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')          
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_ingreso as ci ON (sgd.ano_eje = ci.ano_eje AND sgd.categoria_ingreso = ci.categoria_ingreso AND sgd.estado = ci.estado)
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)
        ${c} AND ge.clasificador = '1.7' GROUP BY a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje) as t6 ON 
        (t.ano_eje = t6.ano_eje AND t.sec_ejec = t6.sec_ejec AND t.sec_ejec2 = t6.sec_ejec2 AND t.sec_nota = t6.sec_nota AND t.mes = t6.mes)
        LEFT JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje as mes, SUM(a.monto_a) - SUM(a.monto_de) as monto7
        FROM presupuesto.nota_modificatoria_ing as a
        LEFT JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        LEFT JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')          
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_ingreso as ci ON (sgd.ano_eje = ci.ano_eje AND sgd.categoria_ingreso = ci.categoria_ingreso AND sgd.estado = ci.estado)
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)
        ${c} AND ge.clasificador = '1.8' GROUP BY a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje) as t7 ON 
        (t.ano_eje = t7.ano_eje AND t.sec_ejec = t7.sec_ejec AND t.sec_ejec2 = t7.sec_ejec2 AND t.sec_nota = t7.sec_nota AND t.mes = t7.mes)
        LEFT JOIN (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje as mes, SUM(a.monto_a) - SUM(a.monto_de) as monto8
        FROM presupuesto.nota_modificatoria_ing as a
        LEFT JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        LEFT JOIN (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')
        ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')          
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND ed.subgenerica = es.subgenerica 
        AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)        
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)
        INNER JOIN presupuesto.categoria_ingreso as ci ON (sgd.ano_eje = ci.ano_eje AND sgd.categoria_ingreso = ci.categoria_ingreso AND sgd.estado = ci.estado)
        INNER JOIN presupuesto.subgenerica as sg ON (ed.ano_eje = sg.ano_eje AND ed.tipo_transaccion = sg.tipo_transaccion AND ed.generica = sg.generica AND 
        ed.subgenerica = sg.subgenerica AND ed.estado = sg.estado)
        INNER JOIN presupuesto.generica as ge ON (ed.ano_eje = ge.ano_eje AND ed.tipo_transaccion = ge.tipo_transaccion AND ed.generica = ge.generica AND ed.estado = ge.estado)
        ${c} AND ge.clasificador = '1.9' GROUP BY a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.mes_eje) as t8 ON 
        (t.ano_eje = t8.ano_eje AND t.sec_ejec = t8.sec_ejec AND t.sec_ejec2 = t8.sec_ejec2 AND t.sec_nota = t8.sec_nota AND t.mes = t8.mes)
        INNER JOIN utilitarios.meses as m ON (t.mes::int = m.mes)
        INNER JOIN presupuesto.ejecutora as ej ON (t.ano_eje = ej.ano_eje AND t.sec_ejec = ej.sec_ejec AND ej.pliego = '459')
        ORDER BY t.ano_eje, t.sec_nota, t.sec_ejec ASC        
    </select>   
    
    <select id="getListNotasNumero" parameterType="HashMap" resultMap="PresupuestoMap">
        SELECT a.sec_nota, a.tipo_modificacion as codigo, e.timo_nombre as nombre, c.nombre as nombre_mes, trim(d.nombre) as nombre_documento, 
        trim(b.num_doc) as num_doc, b.cod_doc, a.glosa, a.fecha as fecha_doc, f.fuente_financ
        FROM (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, b.secuencia, a.tipo_modificacion, a.mes_eje, 
        (CASE WHEN trim(b.sec_doc) = '' THEN ''
        WHEN b.sec_doc = '0000000000' THEN ''
        WHEN b.sec_doc != '0000000000' AND trim(b.sec_doc_r) = '' THEN b.sec_doc
        WHEN b.sec_doc != '0000000000' AND b.sec_doc_r = '0000000000' THEN b.sec_doc
        WHEN b.sec_doc != '0000000000' AND b.sec_doc_r != '0000000000' THEN b.sec_doc_r
        ELSE b.sec_doc_r END) as sec_doc, trim(b.notas) as glosa, b.fecha
        FROM presupuesto.nota_modificatoria_cab as a
        INNER JOIN presupuesto.nota_modificatoria_sec as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)) as a        
        INNER JOIN (
        SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.fuente_financ 
        FROM presupuesto.nota_modificatoria_det as a
        INNER JOIN presupuesto.nota_modificatoria_cab as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota)
        INNER JOIN ( ${c} ) as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota) 
        GROUP BY a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.fuente_financ
        ) as f ON (a.ano_eje = f.ano_eje AND a.sec_ejec = f.sec_ejec AND a.sec_ejec2 = f.sec_ejec2 AND a.sec_nota = f.sec_nota)        
        INNER JOIN presupuesto.nota_modificatoria_doc as b ON (a.ano_eje = b.ano_eje AND a.sec_doc = b.sec_doc)
        INNER JOIN utilitarios.meses as c ON (a.mes_eje::int = c.mes)
        INNER JOIN presupuesto.maestro_documento as d ON (b.cod_doc = d.cod_doc) 
        INNER JOIN presupuesto.tipo_modificacion as e ON (a.tipo_modificacion = e.timo_id) ${d}
    </select>
    
    <select id="getNotaDetalleGasto" parameterType="HashMap" resultMap="PresupuestoMap">
        SELECT a.sec_func, trim(fi.nombre) as nombre_sec_func, a.fuente_financ, trim(ru.nombre) as nombre_fuente_financ, cg.categ_gasto, 
        trim(cg.nombre) as nombre_categ_gasto, ed.clasificador, trim(ed.descripcion) as descripcion, a.monto_a as monto1, a.monto_de as monto0
        FROM presupuesto.nota_modificatoria_det as a
        INNER JOIN presupuesto.fuente_financ as ru ON (a.ano_eje = ru.ano_eje AND a.fuente_financ = ru.fuente_financ AND ru.estado = 'A')  
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')  
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND 
        ed.subgenerica = es.subgenerica AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)         
        INNER JOIN presupuesto.categoria_gasto as cg ON (sgd.ano_eje = cg.ano_eje AND sgd.categoria_gasto = cg.categ_gasto AND sgd.estado = cg.estado)  
        INNER JOIN presupuesto.meta as m ON (a.ano_eje = m.ano_eje AND a.sec_ejec = m.sec_ejec AND a.sec_func = m.sec_func AND m.estado = 'A')
        INNER JOIN presupuesto.finalidad as fi ON (m.ano_eje = fi.ano_eje AND m.finalidad = fi.finalidad AND m.estado = fi.estado) ${c}
    </select>
    
    <select id="getNotaDetalleIngreso" parameterType="HashMap" resultMap="PresupuestoMap">
        SELECT a.fuente_financ, trim(ru.nombre) as nombre_fuente_financ, ci.categoria_ingreso, trim(ci.descripcion) as nombre_categoria_ingreso, 
        ed.clasificador, trim(ed.descripcion) as descripcion, a.monto_a as monto1, a.monto_de as monto0
        FROM presupuesto.nota_modificatoria_ing as a
        INNER JOIN presupuesto.fuente_financ as ru ON (a.ano_eje = ru.ano_eje AND a.fuente_financ = ru.fuente_financ AND ru.estado = 'A')  
        INNER JOIN presupuesto.especifica_det as ed ON (a.ano_eje = ed.ano_eje AND a.id_clasificador = ed.id_clasificador AND ed.estado= 'A')  
        INNER JOIN presupuesto.especifica as es ON (ed.ano_eje = es.ano_eje AND ed.tipo_transaccion = es.tipo_transaccion AND ed.generica = es.generica AND 
        ed.subgenerica = es.subgenerica AND ed.subgenerica_det = es.subgenerica_det AND ed.especifica = es.especifica AND ed.estado = es.estado)
        INNER JOIN presupuesto.subgenerica_det as sgd ON (ed.ano_eje = sgd.ano_eje AND ed.tipo_transaccion = sgd.tipo_transaccion AND ed.generica = sgd.generica AND 
        ed.subgenerica = sgd.subgenerica AND ed.subgenerica_det = sgd.subgenerica_det AND ed.estado = sgd.estado)         
        INNER JOIN presupuesto.categoria_ingreso as ci ON (sgd.ano_eje = ci.ano_eje AND sgd.categoria_ingreso = ci.categoria_ingreso AND sgd.estado = ci.estado) ${c}
    </select>
    
    <select id="getNotaDetalleEjecutoras" parameterType="HashMap" resultMap="PresupuestoMap">
        SELECT a.sec_ejec, ej.ejecutora, trim(ej.nombre) as nombre, a.sec_nota, SUM(c.monto_a) as monto1, SUM(c.monto_de) as monto0
        FROM (SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia,  
        (CASE WHEN trim(a.sec_doc) = '' THEN ''
        WHEN a.sec_doc = '0000000000' THEN ''
        WHEN a.sec_doc != '0000000000' AND trim(a.sec_doc_r) = '' THEN a.sec_doc
        WHEN a.sec_doc != '0000000000' AND a.sec_doc_r = '0000000000' THEN a.sec_doc
        WHEN a.sec_doc != '0000000000' AND a.sec_doc_r != '0000000000' THEN a.sec_doc_r
        ELSE a.sec_doc_r END) as sec_doc
        FROM (SELECT ano_eje, sec_ejec, sec_ejec2, sec_nota, secuencia, fecha, notas, estado, estado2, sec_doc, sec_doc_r
        FROM presupuesto.nota_modificatoria_sec EXCEPT SELECT a.ano_eje, a.sec_ejec, a.sec_ejec2, a.sec_nota, a.secuencia, a.fecha, a.notas, a.estado, 
        a.estado2, a.sec_doc, a.sec_doc_r FROM presupuesto.nota_modificatoria_sec as a INNER JOIN presupuesto.nota_modificatoria_sec as b ON 
        (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.sec_ejec2 = b.sec_ejec2 AND a.sec_nota = b.sec_nota AND b.secuencia = '0002')) as a) as a
        INNER JOIN presupuesto.nota_modificatoria_doc as b ON (a.ano_eje = b.ano_eje AND a.sec_doc = b.sec_doc)
        INNER JOIN presupuesto.nota_modificatoria_det as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.sec_ejec2 = c.sec_ejec2 AND a.sec_nota = c.sec_nota)
        INNER JOIN presupuesto.ejecutora as ej ON (a.ano_eje = ej.ano_eje AND a.sec_ejec = ej.sec_ejec AND ej.pliego = '459') ${c}
    </select>
    
    <select id="getExpedientesSIAF" parameterType="HashMap" resultMap="PresupuestoMap">
        SELECT a.ano_eje, a.sec_ejec, a.expediente, fu.fuente_financ, trim(fu.nombre) as nombre_fuente_financ, tr.tipo_recurso, trim(tr.nombre) as nombre_tipo_recurso
        FROM presupuesto.expediente_fase as a
        LEFT JOIN presupuesto.expediente_documento as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.expediente = b.expediente AND a.ciclo = b.ciclo AND a.fase = b.fase AND a.secuencia = b.secuencia)
        INNER JOIN presupuesto.fuente_financ as fu ON (a.ano_eje = fu.ano_eje AND a.fuente_financ = fu.fuente_financ AND fu.estado = 'A')
        INNER JOIN presupuesto.tipo_recurso as tr ON (a.ano_eje = tr.ano_eje AND a.fuente_financ = tr.fuente_financ AND a.tipo_recurso = tr.tipo_recurso AND tr.estado = 'A')
        LEFT JOIN presupuesto.persona as p ON (a.ruc = p.ruc AND p.estado = 'A') ${c}
    </select>   
    
                 
    <select id="getDetalleExpeSIAFFase" parameterType="HashMap" resultMap="PresupuestoMap">
        SELECT a.expediente, trim(d.nombre) as ciclo, trim(e.nombre) as fase, b.certificado as certificacion, trim(f.nombre) as nombre_documento, a.num_doc, a.monto_nacional as monto, 
        a.ano_cta_cte as ano_eje, trim(g.nombre) as banco, trim(h.nombre) as cta_cte, a.fecha_autorizacion as fecha_doc, a.estado_envio, b.ruc, trim(c.nombre) as nombre
        FROM presupuesto.expediente_secuencia as a
        INNER JOIN presupuesto.expediente_fase as b ON (a.ano_eje = b.ano_eje AND a.sec_ejec = b.sec_ejec AND a.expediente = b.expediente AND a.ciclo = b.ciclo AND a.fase = b.fase AND a.secuencia = b.secuencia)
        LEFT JOIN presupuesto.expediente_documento as c ON (a.ano_eje = c.ano_eje AND a.sec_ejec = c.sec_ejec AND a.expediente = c.expediente AND a.ciclo = c.ciclo AND a.fase = c.fase AND a.secuencia = c.secuencia 
        AND a.correlativo = c.correlativo)
        INNER JOIN presupuesto.ciclo as d ON (a.ciclo = d.ciclo)
        INNER JOIN presupuesto.fase as e ON (a.ciclo = e.ciclo AND a.fase = e.fase)
        INNER JOIN presupuesto.maestro_documento as f ON (a.cod_doc = f.cod_doc)
        LEFT JOIN presupuesto.banco as g ON (a.banco = g.banco AND g.estado = 'A')
        LEFT JOIN presupuesto.cta_cte as h ON (a.sec_ejec = h.sec_ejec AND a.banco = h.banco AND a.cta_cte = h.cta_cte AND a.ano_cta_cte = h.ano_eje AND h.estado = 'A') ${c}        
    </select>     
    
    <select id="getDetalleExpeSIAFFaseGasto" parameterType="HashMap" resultMap="PresupuestoMap">
        SELECT trim(c.nombre) as ciclo, trim(d.nombre) as fase, a.secuencia, a.sec_func, trim(b.clasificador) as clasificador, 
        trim(b.descripcion) as descripcion, a.monto_nacional as monto
        FROM presupuesto.expediente_meta as a
        INNER JOIN presupuesto.especifica_det as b ON (a.ano_eje = b.ano_eje AND a.id_clasificador = b.id_clasificador AND b.estado = 'A')
        INNER JOIN presupuesto.ciclo as c ON (a.ciclo = c.ciclo)
        INNER JOIN presupuesto.fase as d ON (a.ciclo = d.ciclo AND a.fase = d.fase) ${c}        
    </select>     
    
    <select id="getDetalleExpeSIAFFaseIngreso" parameterType="HashMap" resultMap="PresupuestoMap">
        SELECT trim(c.nombre) as ciclo, trim(d.nombre) as fase, a.secuencia, trim(b.clasificador) as clasificador, 
        trim(b.descripcion) as descripcion, a.monto_nacional as monto
        FROM presupuesto.expediente_ingreso as a
        INNER JOIN presupuesto.especifica_det as b ON (a.ano_eje = b.ano_eje AND a.id_clasificador = b.id_clasificador AND b.estado = 'A')
        INNER JOIN presupuesto.ciclo as c ON (a.ciclo = c.ciclo)
        INNER JOIN presupuesto.fase as d ON (a.ciclo = d.ciclo AND a.fase = d.fase) ${c}        
    </select>     
                                                                        
</mapper>
